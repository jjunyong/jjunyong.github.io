<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta data-react-helmet="true" name="google-site-verification" content="MFebU6SslKGXDPKTnr1Em5zriYnNpmZR44U73cLKsj8"/><meta data-react-helmet="true" name="naver-site-verification" content="40e460060b146c8626ef355d6bf7abcf2bdb41ff"/><meta data-react-helmet="true" property="og:title" content="[CKS] System Hardening 2"/><meta data-react-helmet="true" property="og:site_title" content="[CKS] System Hardening 2"/><meta data-react-helmet="true" name="description" content="System Hardening 섹션에서는 하기의 내용들에 대해 다룬다. host OS foorprint 최소화 Node 접근 제한 SSH hardening Linux privilege escalation 불필요 패키지/서비스 제거 커널 모듈 제한 오픈 포트 제한 IAM role UFW 방화벽 Seccomp AppArmor 7. IAM role public cloud의 IAM policy, role을 최소화해야 한다. IAM user 관련 권한 관리는 group 활용하여 IAM policy를 그룹에 부여한다. IAM service 관련 관한 관리는 IAM policy를 service(ec2같은) 에 직접 부여할 수 없기에 IAM role을 활용한다. S3BucketAccessRole과 같은 role을 만들고 IAM policy를 해당 role에 부여한다. 그리고 이 role을 ec2에 부여한다. 8. UFW 방화벽/네트워크 네트웍 외부 접속의 최소화 앞서 보았듯, /etc/servi…"/><meta data-react-helmet="true" property="og:description" content="System Hardening 섹션에서는 하기의 내용들에 대해 다룬다. host OS foorprint 최소화 Node 접근 제한 SSH hardening Linux privilege escalation 불필요 패키지/서비스 제거 커널 모듈 제한 오픈 포트 제한 IAM role UFW 방화벽 Seccomp AppArmor 7. IAM role public cloud의 IAM policy, role을 최소화해야 한다. IAM user 관련 권한 관리는 group 활용하여 IAM policy를 그룹에 부여한다. IAM service 관련 관한 관리는 IAM policy를 service(ec2같은) 에 직접 부여할 수 없기에 IAM role을 활용한다. S3BucketAccessRole과 같은 role을 만들고 IAM policy를 해당 role에 부여한다. 그리고 이 role을 ec2에 부여한다. 8. UFW 방화벽/네트워크 네트웍 외부 접속의 최소화 앞서 보았듯, /etc/servi…"/><meta data-react-helmet="true" property="og:author" content="Jplus"/><meta data-react-helmet="true" property="og:image" content="/logo_square.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><style data-href="/styles.403d7a8a431a9dbd54c6.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}.search-input-wrapper{align-items:center;display:none;margin-top:3px;width:180px}@media(min-width:768px){.search-input-wrapper{display:flex}}.search-icon{color:var(--primary-text-color);margin-right:2px}.search-input{height:100%;width:100%}.search-input .MuiAutocomplete-inputRoot{padding-right:0!important}.search-input .MuiInputBase-input{color:var(--primary-text-color)!important;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;font-weight:500;padding-bottom:2px!important}.search-input .MuiInput-underline:before{border-bottom-color:var(--primary-text-color);border-bottom-width:1px}.search-input .MuiInput-underline:after{border-bottom-color:var(--primary-text-color)}.page-header-wrapper{display:flex;height:60px;justify-content:center;width:100%}.page-header-wrapper .page-header{align-items:center;display:flex;justify-content:space-between;max-width:720px;width:100%}.page-header-wrapper .page-header .link{color:var(--primary-text-color);font-size:17px;font-weight:700}@media(min-width:768px){.page-header-wrapper .page-header .link{font-size:20px;font-weight:700}}.page-header-wrapper .page-header .trailing-section{align-items:center;display:flex}.page-header-wrapper .page-header .trailing-section .link{margin-right:10px}@media(min-width:768px){.page-header-wrapper .page-header .trailing-section .link{margin-right:20px}}.page-footer-wrapper{align-items:center;display:flex;height:62px;justify-content:center;margin-top:auto;width:100%}.page-footer-wrapper .page-footer{max-width:720px;text-align:center;width:100%}.page-footer-wrapper .page-footer .link{color:var(--primary-text-color);font-size:20px;font-weight:700;margin-right:20px}.page-footer-wrapper .page-footer a{color:#3a95ff}.dark-mode-button-wrapper{align-items:center;bottom:20px;display:flex;justify-content:center;position:fixed;right:20px}.dark-mode-button{-webkit-backdrop-filter:blur(30px);backdrop-filter:blur(30px);background-color:#363f47!important;border-radius:50px;box-shadow:0 5px 25px rgba(0,0,0,.12);cursor:pointer;height:50px;width:50px;z-index:3}.dark-mode-icon{color:#fff}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{border:0;font-size:100%;font:inherit;margin:0;padding:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-collapse:collapse;border-spacing:0}a{outline:none;text-decoration:none}html{--background-color:#fff;--primary-text-color:#000;--secondary-text-color:#9e9e9e;--content-text-color:#37352f;--button-background-color:#f3f3f4;--button-text-color:#363f47;--tab-text-color:#6e6d7a;--tab-hover-text-color:#0d0c22;--tab-selected-background-color:rgba(13,12,34,.05);--bio-link-icon-color:rgba(0,0,0,.54);--about-link-icon-color:#a8a8a8;--chip-background-color:#f3f3f4;--link-text-color:rgba(55,53,47,.7);--post-card-border-color:rgba(0,0,0,.12);--markdown-table-even-cell-background-color:#f6f8fa;--markdown-table-border-color:#dfe2e5;--markdown-blockquote-border-color:#dfe2e5;--markdown-border-color:#e1e4e8}html[data-theme=dark]{--background-color:#232326;--primary-text-color:#e6e6e6;--secondary-text-color:#768390;--content-text-color:#e6e6e6;--button-background-color:#444c56;--button-text-color:#363f47;--tab-text-color:#768390;--tab-hover-text-color:#acbac7;--tab-selected-background-color:#373e47;--chip-background-color:#323a42;--bio-link-icon-color:#e6e6e6;--about-link-icon-color:#a8a8a8;--link-text-color:#90b0ec;--post-card-border-color:#363f47;--markdown-table-even-cell-background-color:#2d333b;--markdown-table-border-color:#444c56;--markdown-blockquote-border-color:#4f5864;--markdown-border-color:#e1e4e8}*{-webkit-appearance:none;appearance:none;box-sizing:border-box}html{font-size:14px;height:100%;overflow-y:scroll;width:100%}body{background-color:var(--background-color)!important}a{color:var(--link-text-color)}.page-wrapper{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:var(--primary-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;justify-content:center;min-height:100vh;padding-left:15px;padding-right:15px;word-break:keep-all}.page-wrapper,.page-wrapper .page-content{align-items:center;display:flex;flex-direction:column;width:100%}.page-wrapper .page-content{max-width:720px}.icon{color:var(--about-link-icon-color);font-size:20px}.social-links .icon{color:var(--bio-link-icon-color);font-size:30px}@-webkit-keyframes blinking-cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes blinking-cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}.bio{color:var(--primary-text-color);display:flex;flex-direction:column;justify-content:space-between;margin-bottom:120px;margin-top:120px;width:100%}@media(min-width:768px){.bio{align-items:center;flex-direction:row}}.bio .introduction{display:flex;flex-direction:column;word-break:keep-all}.bio .introduction .react-rotating-text-cursor{-webkit-animation:blinking-cursor .8s cubic-bezier(.68,.01,.01,.99) 0s infinite;animation:blinking-cursor .8s cubic-bezier(.68,.01,.01,.99) 0s infinite}.bio .introduction strong{display:inline-block;font-weight:600}.bio .introduction.korean{font-size:32px;font-weight:100;line-height:1.2}.bio .introduction.korean .title .react-rotating-text-cursor{font-size:35px;line-height:35px}@media(min-width:768px){.bio .introduction.korean{font-size:40px}.bio .introduction.korean .title .react-rotating-text-cursor{font-size:45px;line-height:45px}}.bio .introduction.english{font-family:montserrat;font-size:25px;line-height:1.2}@media(min-width:768px){.bio .introduction.english{font-size:45px}}.bio .introduction.english .name{font-size:35px;font-weight:600}.bio .introduction.english .job{font-size:35px}.bio .introduction.english .description{font-size:20px;font-weight:200;margin-top:8px}.bio .introduction.english .social-links{display:flex;margin-top:20px}.bio .thumbnail-wrapper{display:none}@media(min-width:768px){.bio .thumbnail-wrapper{display:block}}.section-header-wrapper{display:flex;justify-content:center;margin-bottom:32px;width:100%}.section-header-wrapper .section-header{border-bottom:4px solid var(--primary-text-color);color:var(--primary-text-color);font-size:30px;font-weight:700;padding-bottom:5px}.timestamp-section{align-items:center;display:flex;flex-direction:column;justify-content:center;margin-bottom:50px;width:100%;word-break:keep-all}.timestamp-section .body{padding:0 10px;width:100%}.timestamp-section .body .timestamp{border-left:2px solid #bdbdbd;display:flex;font-size:18px;font-weight:400;justify-items:center;margin-left:5px;padding:10px 0;width:100%}.timestamp-section .body .timestamp:first-child{padding-top:7px}.timestamp-section .body .timestamp:last-child{padding-bottom:7px}.timestamp-section .body .timestamp:before{align-self:center;background-color:var(--background-color);border:2px solid #828282;border-radius:10px;content:"";height:10px;left:-1px;position:relative;-webkit-transform:translatex(-50%);transform:translatex(-50%);width:10px}.timestamp-section .body .timestamp .date{align-self:center;color:#828282;margin-left:5px;margin-right:5px;min-width:115px;width:115px}@media(min-width:768px){.timestamp-section .body .timestamp .date{min-width:200px;width:200px}}.timestamp-section .body .timestamp .activity{line-height:23px;width:100%}.project-section{align-items:center;justify-content:center}.project-section,.project-section .project{display:flex;flex-direction:column;width:100%}.project-section .project{margin-bottom:30px;padding:15px}.project-section .project .head{font-size:20px;font-weight:700;line-height:30px;margin-bottom:10px}.project-section .project .body{display:flex;flex-direction:column;width:100%}.project-section .project .body .thumbnail{margin-bottom:10px;width:100%}.project-section .project .body .tech-stack{display:flex;margin-bottom:10px}.project-section .project .body .tech-stack .tech{background-color:var(--chip-background-color);border-radius:10px;font-size:15px;font-weight:500;margin-right:5px;padding:5px 7px}.project-section .project .body .description{font-size:16px;font-weight:400;line-height:1.4}@media(min-width:768px){.project-section .project .body{flex-direction:column}.project-section .project .body .content{margin-top:0}}.post-header{border-bottom:1px solid var(--post-card-border-color);display:flex;flex-direction:column;justify-content:center;margin-bottom:40px;margin-top:20px;padding-bottom:10px;width:100%;word-break:keep-all}.post-header .emoji{font-size:78px;margin-bottom:20px}.post-header .categories{margin-bottom:5px}.post-header .categories .category{color:var(--primary-text-color);font-weight:600;margin-right:4px}.post-header .categories .category:hover{text-decoration:underline}.post-header .title{color:var(--primary-text-color);font-size:32px;font-weight:600;line-height:1.3;margin-bottom:6px}.post-header .info{color:var(--secondary-text-color);display:flex;flex-wrap:wrap;font-size:16px;font-weight:500;line-height:1.5;width:100%}.post-header .info .author{margin-right:4px}.post-header .info strong{color:var(--primary-text-color);font-weight:600}.post-navigator{-webkit-column-gap:1.4%;column-gap:1.4%;display:grid;grid-template-columns:49.3% 49.3%;width:100%}.post-navigator .post-card{border:1px solid var(--post-card-border-color);border-radius:6px;color:var(--primary-text-color);cursor:pointer;display:flex;flex-direction:column;padding:15px;transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s;width:100%}.post-navigator .post-card:hover .title{text-decoration:underline}.post-navigator .post-card.prev{margin-right:auto}.post-navigator .post-card.next{margin-left:auto}.post-navigator .post-card .direction{color:gray;font-size:14px;font-weight:500;margin-bottom:5px}.post-navigator .post-card .title{font-size:16px;font-weight:600;line-height:1.4;margin-bottom:7px}.markdown .octicon{fill:currentColor;display:inline-block;vertical-align:text-bottom}.markdown .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown .anchor:focus{outline:none}.markdown h1 .octicon-link,.markdown h2 .octicon-link,.markdown h3 .octicon-link,.markdown h4 .octicon-link,.markdown h5 .octicon-link,.markdown h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown h1:hover .anchor,.markdown h2:hover .anchor,.markdown h3:hover .anchor,.markdown h4:hover .anchor,.markdown h5:hover .anchor,.markdown h6:hover .anchor{text-decoration:none}.markdown h1:hover .anchor .octicon-link,.markdown h2:hover .anchor .octicon-link,.markdown h3:hover .anchor .octicon-link,.markdown h4:hover .anchor .octicon-link,.markdown h5:hover .anchor .octicon-link,.markdown h6:hover .anchor .octicon-link{visibility:visible}.markdown h1:hover .anchor .octicon-link:before,.markdown h2:hover .anchor .octicon-link:before,.markdown h3:hover .anchor .octicon-link:before,.markdown h4:hover .anchor .octicon-link:before,.markdown h5:hover .anchor .octicon-link:before,.markdown h6:hover .anchor .octicon-link:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E");content:" ";display:inline-block;height:16px;width:16px}.markdown{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-wrap:break-word;color:var(--content-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;font-weight:500;line-height:1.5}.markdown details{display:block}.markdown summary{display:list-item}.markdown a{background-color:initial}.markdown a:active,.markdown a:hover{outline-width:0}.markdown strong{font-weight:inherit;font-weight:bolder}.markdown h1{margin:.67em 0}.markdown img{border-style:none}.markdown code,.markdown kbd,.markdown pre{font-family:monospace,monospace;font-size:1em}.markdown hr{box-sizing:initial;overflow:visible}.markdown input{font:inherit;margin:0;overflow:visible}.markdown [type=checkbox]{box-sizing:border-box;padding:0}.markdown *{box-sizing:border-box}.markdown input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown a{border-bottom:.05em solid;border-color:var(--link-text-color);color:var(--link-text-color);text-decoration:none}.markdown a.anchor{border-bottom:none}.markdown strong{font-weight:700}.markdown hr{background:transparent;border-bottom:1px solid var(--markdown-blockquote-border-color);height:0;margin:15px 0;overflow:hidden}.markdown hr:after,.markdown hr:before{content:"";display:table}.markdown hr:after{clear:both}.markdown table{border-collapse:collapse;border-spacing:0}.markdown td,.markdown th{padding:0}.markdown details summary{cursor:pointer}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{margin-bottom:0;margin-top:0}.markdown h1{font-size:32px}.markdown h1,.markdown h2{font-weight:600}.markdown h2{font-size:24px}.markdown h3{font-size:20px}.markdown h3,.markdown h4{font-weight:600}.markdown h4{font-size:16px}.markdown h5{font-size:14px}.markdown h5,.markdown h6{font-weight:600}.markdown h6{font-size:12px}.markdown p{margin-bottom:10px;margin-top:0}.markdown blockquote{margin:0}.markdown ol,.markdown ul{margin-bottom:0;margin-top:0;padding-left:0}.markdown ol ol,.markdown ul ol{list-style-type:lower-roman}.markdown ol ol ol,.markdown ol ul ol,.markdown ul ol ol,.markdown ul ul ol{list-style-type:lower-alpha}.markdown dd{margin-left:0}.markdown code,.markdown pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown code.language-text{border-radius:3px;font-size:85%;padding:.2em .4em}.markdown :not(pre)>code.language-text{background:hsla(44,6%,50%,.15);color:#eb5757;overflow-wrap:break-word}.markdown pre{margin-bottom:0;margin-top:0}.markdown input::-webkit-inner-spin-button,.markdown input::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}.markdown :checked+.radio-label{border-color:#0366d6;position:relative;z-index:1}.markdown .border{border:1px solid var(--markdown-border-color)!important}.markdown .border-0{border:0!important}.markdown .border-bottom{border-bottom:1px solid var(--markdown-border-color)!important}.markdown .rounded-1{border-radius:3px!important}.markdown .bg-white{background-color:transparent!important}.markdown .bg-gray-light{background-color:#fafbfc!important}.markdown .text-gray-light{color:#6a737d!important}.markdown .pl-3,.markdown .px-3{padding-left:16px!important}.markdown .px-3{padding-right:16px!important}.markdown .f6{font-size:12px!important}.markdown .lh-condensed{line-height:1.25!important}.markdown .text-bold{font-weight:600!important}.markdown .pl-c{color:#6a737d}.markdown .pl-c1,.markdown .pl-s .pl-v{color:#005cc5}.markdown .pl-e,.markdown .pl-en{color:#6f42c1}.markdown .pl-s .pl-s1,.markdown .pl-smi{color:#24292e}.markdown .pl-ent{color:#22863a}.markdown .pl-k{color:#d73a49}.markdown .pl-pds,.markdown .pl-s,.markdown .pl-s .pl-pse .pl-s1,.markdown .pl-sr,.markdown .pl-sr .pl-cce,.markdown .pl-sr .pl-sra,.markdown .pl-sr .pl-sre{color:#032f62}.markdown .pl-smw,.markdown .pl-v{color:#e36209}.markdown .pl-bu{color:#b31d28}.markdown .pl-ii{background-color:#b31d28;color:#fafbfc}.markdown .pl-c2{background-color:#d73a49;color:#fafbfc}.markdown .pl-c2:before{content:"^M"}.markdown .pl-sr .pl-cce{color:#22863a;font-weight:700}.markdown .pl-ml{color:#735c0f}.markdown .pl-mh,.markdown .pl-mh .pl-en,.markdown .pl-ms{color:#005cc5;font-weight:700}.markdown .pl-mi{color:#24292e;font-style:italic}.markdown .pl-mb{color:#24292e;font-weight:700}.markdown .pl-md{background-color:#ffeef0;color:#b31d28}.markdown .pl-mi1{background-color:#f0fff4;color:#22863a}.markdown .pl-mc{background-color:#ffebda;color:#e36209}.markdown .pl-mi2{background-color:#005cc5;color:#f6f8fa}.markdown .pl-mdr{color:#6f42c1;font-weight:700}.markdown .pl-ba{color:#586069}.markdown .pl-sg{color:#959da5}.markdown .pl-corl{color:#032f62;text-decoration:underline}.markdown .mb-0{margin-bottom:0!important}.markdown .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown .pl-0{padding-left:0!important}.markdown .py-0{padding-bottom:0!important;padding-top:0!important}.markdown .pl-1{padding-left:4px!important}.markdown .pl-2{padding-left:8px!important}.markdown .py-2{padding-bottom:8px!important;padding-top:8px!important}.markdown .pl-3{padding-left:16px!important}.markdown .pl-4{padding-left:24px!important}.markdown .pl-5{padding-left:32px!important}.markdown .pl-6{padding-left:40px!important}.markdown .pl-7{padding-left:48px!important}.markdown .pl-8{padding-left:64px!important}.markdown .pl-9{padding-left:80px!important}.markdown .pl-10{padding-left:96px!important}.markdown .pl-11{padding-left:112px!important}.markdown .pl-12{padding-left:128px!important}.markdown hr{border-bottom-color:#eee}.markdown kbd{background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da;color:#444d56;display:inline-block;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown:after,.markdown:before{content:"";display:table}.markdown:after{clear:both}.markdown>:first-child{margin-top:0!important}.markdown>:last-child{margin-bottom:0!important}.markdown a:not([href]){color:inherit;text-decoration:none}.markdown blockquote,.markdown details,.markdown dl,.markdown ol,.markdown p,.markdown pre,.markdown table,.markdown ul{margin-bottom:16px;margin-top:0}.markdown hr{background-color:var(--markdown-border-color);border:0;height:.25em;margin:24px 0;padding:0}.markdown blockquote{border-left:.25em solid var(--markdown-blockquote-border-color);color:#6a737d;padding:0 1em}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown h1{font-size:2em}.markdown h2{font-size:1.5em}.markdown h3{font-size:1.25em}.markdown h4{font-size:1em}.markdown h5{font-size:.875em}.markdown h6{color:#6a737d;font-size:.85em}.markdown ol,.markdown ul{padding-left:2em}.markdown ol ol,.markdown ol ul,.markdown ul ol,.markdown ul ul{margin-bottom:0;margin-top:0}.markdown ol{list-style-type:decimal}.markdown ul{list-style-type:disc}.markdown li{word-wrap:break-all;display:list-item;text-align:-webkit-match-parent}.markdown li>p{margin-top:16px}.markdown li+li{margin-top:.25em}.markdown dl{padding:0}.markdown dl dt{font-size:1em;font-style:italic;font-weight:600;margin-top:16px;padding:0}.markdown dl dd{margin-bottom:16px;padding:0 16px}.markdown table{display:block;overflow:auto;width:100%}.markdown table th{font-weight:600}.markdown table td,.markdown table th{border:1px solid var(--markdown-table-border-color);padding:6px 13px}.markdown table tr{border-top:1px solid var(--markdown-table-border-color)}.markdown table tr:nth-child(2n){background-color:var(--markdown-table-even-cell-background-color)}.markdown img{background-color:transparent;box-sizing:initial;display:block;margin:0 auto;max-width:100%}.markdown img[align=right]{padding-left:20px}.markdown img[align=left]{padding-right:20px}.markdown code{background-color:rgba(27,31,35,.05);border-radius:3px;font-size:85%;margin:0;padding:.2em .4em}.markdown pre{word-wrap:normal}.markdown pre>code{background:transparent;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown .highlight{margin-bottom:16px}.markdown .highlight pre{margin-bottom:0;word-break:normal}.markdown .highlight pre,.markdown pre{background-color:#f6f8fa;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}.markdown pre code{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown .commit-tease-sha{color:#444d56;display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%}.markdown .full-commit .btn-outline:not(:disabled):hover{border-color:#005cc5;color:#005cc5}.markdown .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown .blob-num{color:rgba(27,31,35,.3);cursor:pointer;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;min-width:50px;padding-left:10px;padding-right:10px;text-align:right;-webkit-user-select:none;user-select:none;vertical-align:top;white-space:nowrap;width:1%}.markdown .blob-num:hover{color:rgba(27,31,35,.6)}.markdown .blob-num:before{content:attr(data-line-number)}.markdown .blob-code{line-height:20px;padding-left:10px;padding-right:10px;position:relative;vertical-align:top}.markdown .blob-code-inner{word-wrap:normal;color:#24292e;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;overflow:visible;white-space:pre}.markdown .pl-token.active,.markdown .pl-token:hover{background:#ffea7f;cursor:pointer}.markdown .tab-size[data-tab-size="1"]{-o-tab-size:1;tab-size:1}.markdown .tab-size[data-tab-size="2"]{-o-tab-size:2;tab-size:2}.markdown .tab-size[data-tab-size="3"]{-o-tab-size:3;tab-size:3}.markdown .tab-size[data-tab-size="4"]{-o-tab-size:4;tab-size:4}.markdown .tab-size[data-tab-size="5"]{-o-tab-size:5;tab-size:5}.markdown .tab-size[data-tab-size="6"]{-o-tab-size:6;tab-size:6}.markdown .tab-size[data-tab-size="7"]{-o-tab-size:7;tab-size:7}.markdown .tab-size[data-tab-size="8"]{-o-tab-size:8;tab-size:8}.markdown .tab-size[data-tab-size="9"]{-o-tab-size:9;tab-size:9}.markdown .tab-size[data-tab-size="10"]{-o-tab-size:10;tab-size:10}.markdown .tab-size[data-tab-size="11"]{-o-tab-size:11;tab-size:11}.markdown .tab-size[data-tab-size="12"]{-o-tab-size:12;tab-size:12}.markdown .task-list-item{list-style-type:none}.markdown .task-list-item+.task-list-item{margin-top:3px}.markdown .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown .table-of-contents{align-items:flex-start;display:flex;flex-direction:column;justify-content:center;position:fixed;right:0;top:75px;width:340px}@media(max-width:1300px){.markdown .table-of-contents{display:none}}.markdown .table-of-contents ul{cursor:pointer;list-style-type:none}.markdown .table-of-contents ul li a{border-bottom:none;color:var(--secondary-text-color);font-size:14px;height:30px;padding:6px 2px;width:100%}.markdown .table-of-contents ul p{margin:0}.markdown .gatsby-resp-image-wrapper{display:flex!important;justify-content:center!important;max-height:560px!important;width:100%!important}.markdown .gatsby-resp-image-wrapper img{height:auto!important;max-height:560px!important;max-width:100%!important;position:relative!important;width:auto!important}.markdown .gatsby-resp-image-wrapper+em{color:#6a737d;display:block;font-size:15px;font-style:italic;text-align:center}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.post-content{margin-bottom:20px;width:100%}.category-page-header-wrapper,.post-content{display:flex;flex-direction:column;justify-content:center}.category-page-header-wrapper{align-items:center;margin-bottom:30px;margin-top:30px}.category-page-header-wrapper .category-page-title{border-bottom:3px solid var(--primary-text-color);font-size:40px;font-weight:700;margin-bottom:15px;padding-bottom:7px;text-align:center;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.category-page-header-wrapper .category-page-subtitle{font-size:20px;font-weight:500;padding-bottom:10px;text-align:center}.post-card-wrapper{display:flex;justify-content:center;min-height:150px;width:100%}.post-card-wrapper .post-card{border:1px solid var(--post-card-border-color);border-radius:6px;color:var(--primary-text-color);cursor:pointer;display:flex;flex-direction:column;height:100%;margin-bottom:15px;max-width:720px;padding:15px;transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s;width:100%}.post-card-wrapper .post-card:hover .title{text-decoration:underline}@media(min-width:768px){.post-card-wrapper .post-card{margin-bottom:0}}.post-card-wrapper .post-card .title{font-size:18px;font-weight:600;line-height:1.4;margin-bottom:7px}.post-card-wrapper .post-card .description{-webkit-line-clamp:3;-webkit-box-orient:vertical;color:var(--primary-text-color);display:-webkit-box;font-size:13px;line-height:20px;margin-bottom:10px;overflow:hidden;text-overflow:ellipsis}.post-card-wrapper .post-card .info{color:var(--about-link-icon-color);display:flex;font-size:14px;justify-content:space-between;margin-top:auto}.post-card-wrapper .post-card .info .categories{display:flex}.post-card-wrapper .post-card .info .categories .category{margin-left:4px}.post-card-wrapper .post-card .info .categories .category:hover{text-decoration:underline}.post-card-column-wrapper{display:flex;justify-content:center;width:100%}.post-card-column-wrapper .post-card-column{align-items:center;display:flex;flex-direction:column;width:100%}.post-card-column-wrapper .post-card-column .post-card-wrapper{margin-bottom:10px}.post-card-column-wrapper .post-card-column .more-post-card-button{background-color:var(--button-background-color);color:var(--tab-hover-text-color);font-size:15px;font-weight:500;height:40px}.post-tabs-wrapper{align-self:flex-start;display:flex;flex-direction:column;justify-content:center;top:0;width:100%}.post-tabs-wrapper .post-tabs{display:flex;height:40px;justify-content:center;margin-bottom:12px;max-width:760px;width:100%}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTab-root{color:var(--tab-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:17px;font-weight:500;height:40px;min-height:auto;min-width:auto;padding:10px 12px;transition:all .2s ease}.post-tabs-wrapper .post-tabs .mui-tabs .Mui-selected,.post-tabs-wrapper .post-tabs .mui-tabs .MuiTab-root :hover{color:var(--tab-hover-text-color);transition:all .2s ease}.post-tabs-wrapper .post-tabs .mui-tabs .Mui-selected{background-color:var(--tab-selected-background-color);border-radius:8px;font-weight:600}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabScrollButton-root{height:40px;width:20px}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabs-scrollable{height:40px}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabs-indicator{display:none}</style><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css-global 1prfaxn">@-webkit-keyframes mui-auto-fill{from{display:block;}}@keyframes mui-auto-fill{from{display:block;}}@-webkit-keyframes mui-auto-fill-cancel{from{display:block;}}@keyframes mui-auto-fill-cancel{from{display:block;}}</style><style data-emotion="css 18nc3u2 feqhe6 12rx5qu mnn31 vubbuv 1yxmbwk 6flbmm">.css-18nc3u2.Mui-focused .MuiAutocomplete-clearIndicator{visibility:visible;}@media (pointer: fine){.css-18nc3u2:hover .MuiAutocomplete-clearIndicator{visibility:visible;}}.css-18nc3u2 .MuiAutocomplete-tag{margin:3px;max-width:calc(100% - 6px);}.css-18nc3u2 .MuiAutocomplete-inputRoot{-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.MuiAutocomplete-hasPopupIcon.css-18nc3u2 .MuiAutocomplete-inputRoot,.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiAutocomplete-inputRoot{padding-right:30px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiAutocomplete-inputRoot{padding-right:56px;}.css-18nc3u2 .MuiAutocomplete-inputRoot .MuiAutocomplete-input{width:0;min-width:30px;}.css-18nc3u2 .MuiInput-root{padding-bottom:1px;}.css-18nc3u2 .MuiInput-root .MuiInput-input{padding:4px 4px 4px 0px;}.css-18nc3u2 .MuiInput-root.MuiInputBase-sizeSmall .MuiInput-input{padding:2px 4px 3px 0;}.css-18nc3u2 .MuiOutlinedInput-root{padding:9px;}.MuiAutocomplete-hasPopupIcon.css-18nc3u2 .MuiOutlinedInput-root,.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiOutlinedInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiOutlinedInput-root{padding-right:65px;}.css-18nc3u2 .MuiOutlinedInput-root .MuiAutocomplete-input{padding:7.5px 4px 7.5px 5px;}.css-18nc3u2 .MuiOutlinedInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-18nc3u2 .MuiOutlinedInput-root.MuiInputBase-sizeSmall{padding-top:6px;padding-bottom:6px;padding-left:6px;}.css-18nc3u2 .MuiOutlinedInput-root.MuiInputBase-sizeSmall .MuiAutocomplete-input{padding:2.5px 4px 2.5px 8px;}.css-18nc3u2 .MuiFilledInput-root{padding-top:19px;padding-left:8px;}.MuiAutocomplete-hasPopupIcon.css-18nc3u2 .MuiFilledInput-root,.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiFilledInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiFilledInput-root{padding-right:65px;}.css-18nc3u2 .MuiFilledInput-root .MuiFilledInput-input{padding:7px 4px;}.css-18nc3u2 .MuiFilledInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-sizeSmall{padding-bottom:1px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-sizeSmall .MuiFilledInput-input{padding:2.5px 4px;}.css-18nc3u2 .MuiInputBase-hiddenLabel{padding-top:8px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-hiddenLabel{padding-top:0;padding-bottom:0;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-hiddenLabel .MuiAutocomplete-input{padding-top:16px;padding-bottom:17px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-hiddenLabel.MuiInputBase-sizeSmall .MuiAutocomplete-input{padding-top:8px;padding-bottom:9px;}.css-18nc3u2 .MuiAutocomplete-input{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;opacity:1;}.css-feqhe6{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;min-width:0;padding:0;margin:0;border:0;vertical-align:top;width:100%;}.css-12rx5qu{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.4375em;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.87);box-sizing:border-box;position:relative;cursor:text;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;position:relative;}.css-12rx5qu.Mui-disabled{color:rgba(0, 0, 0, 0.38);cursor:default;}label+.css-12rx5qu{margin-top:16px;}.css-12rx5qu:after{border-bottom:2px solid #1976d2;left:0;bottom:0;content:"";position:absolute;right:0;-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);-webkit-transition:-webkit-transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;transition:transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;pointer-events:none;}.css-12rx5qu.Mui-focused:after{-webkit-transform:scaleX(1) translateX(0);-moz-transform:scaleX(1) translateX(0);-ms-transform:scaleX(1) translateX(0);transform:scaleX(1) translateX(0);}.css-12rx5qu.Mui-error:before,.css-12rx5qu.Mui-error:after{border-bottom-color:#d32f2f;}.css-12rx5qu:before{border-bottom:1px solid rgba(0, 0, 0, 0.42);left:0;bottom:0;content:"\00a0";position:absolute;right:0;-webkit-transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;pointer-events:none;}.css-12rx5qu:hover:not(.Mui-disabled, .Mui-error):before{border-bottom:2px solid rgba(0, 0, 0, 0.87);}@media (hover: none){.css-12rx5qu:hover:not(.Mui-disabled, .Mui-error):before{border-bottom:1px solid rgba(0, 0, 0, 0.42);}}.css-12rx5qu.Mui-disabled:before{border-bottom-style:dotted;}.css-mnn31{font:inherit;letter-spacing:inherit;color:currentColor;padding:4px 0 5px;border:0;box-sizing:content-box;background:none;height:1.4375em;margin:0;-webkit-tap-highlight-color:transparent;display:block;min-width:0;width:100%;-webkit-animation-name:mui-auto-fill-cancel;animation-name:mui-auto-fill-cancel;-webkit-animation-duration:10ms;animation-duration:10ms;}.css-mnn31::-webkit-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-moz-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:focus{outline:0;}.css-mnn31:invalid{box-shadow:none;}.css-mnn31::-webkit-search-decoration{-webkit-appearance:none;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-webkit-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-moz-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-webkit-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-moz-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus:-ms-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-ms-input-placeholder{opacity:0.42;}.css-mnn31.Mui-disabled{opacity:1;-webkit-text-fill-color:rgba(0, 0, 0, 0.38);}.css-mnn31:-webkit-autofill{-webkit-animation-duration:5000s;animation-duration:5000s;-webkit-animation-name:mui-auto-fill;animation-name:mui-auto-fill;}.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}.css-1yxmbwk{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1yxmbwk::-moz-focus-inner{border-style:none;}.css-1yxmbwk.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1yxmbwk{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1yxmbwk:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1yxmbwk:hover{background-color:transparent;}}.css-1yxmbwk.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}.css-6flbmm{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:2.1875rem;}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-Y2TNPV9C3Z',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-Y2TNPV9C3Z', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="icon" href="/favicon-32x32.png?v=a4a2f53822680309c3d24ddfc3d00720" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a4a2f53822680309c3d24ddfc3d00720"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a4a2f53822680309c3d24ddfc3d00720"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a4a2f53822680309c3d24ddfc3d00720"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a4a2f53822680309c3d24ddfc3d00720"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a4a2f53822680309c3d24ddfc3d00720"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a4a2f53822680309c3d24ddfc3d00720"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a4a2f53822680309c3d24ddfc3d00720"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a4a2f53822680309c3d24ddfc3d00720"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2"/><style>@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxM.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc-.woff) format("woff")}</style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">[CKS] System Hardening 2</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="page-wrapper"><header class="page-header-wrapper"><div class="page-header"><div class="front-section"><a class="link" href="/">Steady and Slow</a></div><div class="trailing-section"><a class="link" href="/about">about</a><a class="link" href="/posts">posts</a><div class="MuiAutocomplete-root MuiAutocomplete-hasPopupIcon css-18nc3u2"><div class="search-input-wrapper"><div class="MuiFormControl-root MuiFormControl-fullWidth MuiTextField-root search-input css-feqhe6"><div class="MuiInputBase-root MuiInput-root MuiInput-underline MuiInputBase-colorPrimary MuiInputBase-fullWidth MuiInputBase-formControl MuiInputBase-adornedEnd MuiAutocomplete-inputRoot css-12rx5qu"><input type="text" aria-invalid="false" autoComplete="off" value="" class="MuiInputBase-input MuiInput-input MuiInputBase-inputAdornedEnd MuiAutocomplete-input MuiAutocomplete-inputFocused css-mnn31" aria-autocomplete="list" aria-expanded="false" autoCapitalize="none" spellcheck="false" role="combobox"/><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium search-icon css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="SearchOutlinedIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></div></div></div></div></div></div></header><main class="page-content"><header class="post-header"><div class="emoji">🧢</div><div class="info"><div class="categories"><a class="category" href="/posts/DevOps">DevOps</a></div></div><h1 class="title">[CKS] System Hardening 2</h1><div class="info"><div class="author">posted by <strong>jjunyong</strong>,</div> <!-- -->October 09, 2023</div></header><div class="post-content"><div class="markdown"><p>System Hardening 섹션에서는 하기의 내용들에 대해 다룬다.</p>
<ul>
<li>host OS foorprint 최소화</li>
<li>Node 접근 제한</li>
<li>SSH hardening</li>
<li>Linux privilege escalation</li>
<li>불필요 패키지/서비스 제거</li>
<li>커널 모듈 제한</li>
<li>오픈 포트 제한</li>
<li>IAM role</li>
<li>UFW 방화벽</li>
<li>Seccomp</li>
<li>AppArmor</li>
</ul>
<h3 id="7-iam-role" style="position:relative;"><a href="#7-iam-role" aria-label="7 iam role permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. IAM role</h3>
<p>public cloud의 IAM policy, role을 최소화해야 한다.</p>
<ul>
<li>IAM user 관련 권한 관리는 group 활용하여 IAM policy를 그룹에 부여한다.</li>
<li>IAM service 관련 관한 관리는 IAM policy를 service(ec2같은) 에 직접 부여할 수 없기에 IAM role을 활용한다.
<ul>
<li>S3BucketAccessRole과 같은 role을 만들고 IAM policy를 해당 role에 부여한다. 그리고 이 role을 ec2에 부여한다.</li>
</ul>
</li>
</ul>
<h3 id="8-ufw-방화벽네트워크" style="position:relative;"><a href="#8-ufw-%EB%B0%A9%ED%99%94%EB%B2%BD%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC" aria-label="8 ufw 방화벽네트워크 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. UFW 방화벽/네트워크</h3>
<h4 id="네트웍-외부-접속의-최소화" style="position:relative;"><a href="#%EB%84%A4%ED%8A%B8%EC%9B%8D-%EC%99%B8%EB%B6%80-%EC%A0%91%EC%86%8D%EC%9D%98-%EC%B5%9C%EC%86%8C%ED%99%94" aria-label="네트웍 외부 접속의 최소화 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>네트웍 외부 접속의 최소화</h4>
<ul>
<li>앞서 보았듯, /etc/services 에서 port와 service 의 매핑 관계를 확인할 수 있다.</li>
<li><code class="language-text">netstat -an | grep 22 | grep -w LISTEN</code>의 결과로 0.0.0.0로 listen 중이라면 같은 네트웍에서 어떤 device든 ssh로 접근 가능한 상태를 의미한다.</li>
<li>엔터프라이즈 환경에서는 대부분 방화벽 솔루션을 사용하지만 linux의 UFW를 통해서도 방화벽 설정을 할 수 있다.</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 46.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACPElEQVQozyWS20/TYADF9yebaCIgxCBi1GA0IRKNT/qAPIAJIuBg3LZBYYNxGdu4jHYXRrt1a/t9Xbu1G/7M4Plccs7JiQghcCybLxmF6aNdrGYTKSVCekjpMsCl6+IYOqXFearJHbTFecyLPNL3H/iGqmKoN7RMk8hAYFkW744VXh8rNFsmbenQ1rO4dh3X8/D7fYyTQ45Gn3I585HU0BMqf5fo/ANVSXA2McLpxAjFjTUiziCBbVNOxtF2NmnbFlI6eEYWz21hq0Vk3cBWr9EWfnJ3dkJp6RfGfhKvF9Kslh6SawtzNEoaEUdKjPgm29ElNmIrGNsx2q7Ed5u0zk9opnZpKAlEWcNIK1zPfqcSXcFrFPHNC6rrK1Q316kmth6MI7Z+RyW6zNDpPs9yadS1ZZxSka5+QGPrD6FQ8Ws56mmFwo9v5MaHyUy8wB20EILs5w9k34yRnZokMz78uKG+ESWZ2CKuJNBjqwjLoht2sAvnWIcKrdQesnyDdGwMTaVl1OlaJbpmgVpsFS2+TUlJUv49T0S4bVyzQWFtmdzqEr5p0g18gppC6Lewyyqidss9YF4WqOwlqCpJPGET9Ps0b67If50mN/MJPX9OZHARR0jGUjs8P9jGkYKw4xF4Dl3fQ61UyBcKeP0e2sIs129fkpscRZgNesBtJs3V1ASX719Rim89GrpCMHd6yOzZEV7bJQgCgrBHGPbwPY9Ox+f+/p6g16dhNnHcNkEY0u108DtddKNO7U5HSJf/lq18wNuvGEoAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image1"
        title="image1"
        src="/static/60461f36408dc2d89c330561d3e626d6/37523/image1.png"
        srcset="/static/60461f36408dc2d89c330561d3e626d6/e9ff0/image1.png 180w,
/static/60461f36408dc2d89c330561d3e626d6/f21e7/image1.png 360w,
/static/60461f36408dc2d89c330561d3e626d6/37523/image1.png 720w,
/static/60461f36408dc2d89c330561d3e626d6/302a4/image1.png 1080w,
/static/60461f36408dc2d89c330561d3e626d6/07a9c/image1.png 1440w,
/static/60461f36408dc2d89c330561d3e626d6/5c4aa/image1.png 2492w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<h4 id="ufw-firewall-기본" style="position:relative;"><a href="#ufw-firewall-%EA%B8%B0%EB%B3%B8" aria-label="ufw firewall 기본 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UFW Firewall 기본</h4>
<ul>
<li>Linux 커널에는 netfilter라는 패킷 필터링 기능이 존재한다. 그리고 iptable은 netfilter의 가장 많이 사용되는 interface이다. 근데 iptable을 활용해서 방화벽을 설정하는 것은 러닝커브가 존재한다.</li>
<li>따라서 UFW(Uncomplicated Firewall는 iptable을 위한 interface이고 매우 간단하게 방화벽 rule을 적용할 수 있다.</li>
<li>UFW 설치
<ul>
<li><code class="language-text">apt-get update</code>, <code class="language-text">apt-get install ufw</code></li>
<li><code class="language-text">systemctl enable ufw</code>, <code class="language-text">systemctl start ufw</code></li>
</ul>
</li>
<li>시나리오 케이스에 대한 조치
<ul>
<li><strong><u>시나리오 : A로부터의 22/80 접근만 허용하고 대역으로부터는 80포트만 열어준다. 그 외 8080 포트 등의 모든 접근은 block한다.</u></strong></li>
<li>우선, in/outbound에 대한 디폴트 설정으로 모든 outbound는 열어주고 inbound는 막아준다.
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw default allow outgoing </code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw default deny incoming </code></pre></div>
</li>
<li>A ip로부터 22, 80 포트 접속 허용해준다.
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw allow from {A's ipaddress} to any port 22 proto tcp</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw allow from {A's ipaddress} to any port 80 proto tcp</code></pre></div>
</li>
<li>아래와 같이 대역으로도 허용할 수 있다.
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw allow from 10.2.3.0/28 to any port 80 proto tcp</code></pre></div>
</li>
<li>8080 포트를 모든 소스로부터 막아준다. 사실 이 부분은 defulat로 모두 막고 시작했기 때문에 안해도 되는 부분이긴 하다.
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw deny 8080</code></pre></div>
</li>
<li>마지막으로 rule 적용을 위해 ufw enable 을 해준다.
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw enable</code></pre></div>
<ul>
<li>반대로, rule은 그대로 저장해두고 rule정책을 비활성화 하려면 <code class="language-text">ufw disable</code>하면 된다.</li>
</ul>
</li>
<li><code class="language-text">ufw status</code> 명령으로 적용된 방화벽 정책을 확인할 수 있는데, 디폴트 설정은 안나오는 듯 하다.</li>
<li>아래와 같이 하여 rule을 삭제할 수 있다.
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ufw delete deny 8080</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># ufw status에서의 리스트된 위에서 부터 4번째 rule 삭제
ufw delete 4</code></pre></div>
</li>
</ul>
</li>
</ul>
<h4 id="lab" style="position:relative;"><a href="#lab" aria-label="lab permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>LAB</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># tcp 1000~2000 사이의 포트 오픈
ufw allow 1000:2000/tcp</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># ufw rule을 디폴트 rule로 reset
ufw reset</code></pre></div>
<h3 id="9-seccomp" style="position:relative;"><a href="#9-seccomp" aria-label="9 seccomp permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. Seccomp</h3>
<p>Seccomp에 대해 알아보기 전에 2가지에 대해서 먼저 알아보자</p>
<ul>
<li>Linux syscalls</li>
<li>AquaSec tracee</li>
</ul>
<h4 id="linux-syscalls" style="position:relative;"><a href="#linux-syscalls" aria-label="linux syscalls permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Linux syscalls</h4>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACK0lEQVQoz32Sz2sTURDHg1496NGbgnjSox4svXnSgyL4L3jxpiiohyKFWrD1ID0k1EAtChUPbdKibZCaprEaFSut/ZGkMWmym2azm3SzSXaT7MaP7LNbtAcffJnHvJnPzLz3fMqOwvWZG5x+3Utv+Bo9oaucn7rMhdAVzk1e4tREDxPfJqEN7+LzjAZHGX8+ztjYmFAwGCQQCOD3+0mlUviUksJIIsidWD8Pl57QF3/Mg8VB7kcH6Fsa4m6sn3jyE7bV4cvKV6bCU0TmIszOzjI9PU04HBYKhULkcjl8ZbWModWwdJN6xSA+v8jb0BsyG1s4TZu20UKv6jQaDcymSUWrYNs2nU4HVVWp1+u4q9vtihifoihsF/Jkt7PktnMkPidYWFwgmUpSkCXyUh43xjJNkaDrOoZhCFC1WhWq1WrC71pfsVikXC7TarVEgic3wTRNYSVJEuftdlvI3VuWJdRsNkWMW8TVH+BeB66jKMvIkoSmqrQsi/qezwO61gO6BV2g14AAqpUKJU1DLikUJIl0NstmJkO+UECt7qLpOrphCIh7bwe79KD7wMrODqWNddR0mnpNR/uZobi2SnO3Sk2W2N1K09A0nG53/zE88N9Qr0vf6tMh5o4fIXr2JD8mXhA9c4LI0UMs37tF9GIPkWOH+X77Jr8Ap9PBcez/A/OJjywPDbAWGKGU3GT9mZ+V4UGkDzFSr16yOvwIOfZefA3HtnEc55/RD479G+JxwVSuu8B6AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image2"
        title="image2"
        src="/static/5d743e5e4e70ad2b1ae7852951190e6b/37523/image2.png"
        srcset="/static/5d743e5e4e70ad2b1ae7852951190e6b/e9ff0/image2.png 180w,
/static/5d743e5e4e70ad2b1ae7852951190e6b/f21e7/image2.png 360w,
/static/5d743e5e4e70ad2b1ae7852951190e6b/37523/image2.png 720w,
/static/5d743e5e4e70ad2b1ae7852951190e6b/302a4/image2.png 1080w,
/static/5d743e5e4e70ad2b1ae7852951190e6b/07a9c/image2.png 1440w,
/static/5d743e5e4e70ad2b1ae7852951190e6b/d50e7/image2.png 2280w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
위와 같이 user space에서 동작하는 프로세스는 리소스를 사용하기 위해 kernel에 접근해야 하는데 이 때 system call이 Linux kernel에 대한 interface역할을 한다.</p>
<ul>
<li>strace
<ul>
<li>/usr/bin/strace 에 보통 위치하며 애플리케이션에 의해서 호출된 syscall을 trace하기에 적합하다. 아래는 예시이다.
<ul>
<li>execve가 호출된 syscall의 이름이다.</li>
<li>23 vars는 23개 변수가 systemcall에 전달되었음을 의미하며 여기서 23개 변수는 env의 환경변수를 의미한다.</li>
</ul>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6UlEQVQoz63Ou26DMBQGYI9sqBGlXGJoCmVoXo/LhgBTWggDA9dXJcBf2RLpkiVqLX06ts/5pUPyr09cqguqqkJd1yi/SxRFgTRNhZwxZFn2+85zYf/jNUkSIY5jEE15hmOfcLJsUY+6CWqYoLoJQ9Xgvr6J+1EzoCgKKKWwLAuqqkJXX2CbFIenA2RZhiRJIIQQ/Cu+NmMMZVmKtX3fRxiGN1EU3cV7QRDc8BxHrssVy7JgnmdRHz3btmFdV5HliPPu4Pxxhud5cF33z0jTNOi6Tuj7HsMwYBxHYZqmu/Y+n+WZPd+2LX4A/Joz5lo/TYMAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image3"
        title="image3"
        src="/static/d58a86281bd1ae4337dab1dd9b256a84/37523/image3.png"
        srcset="/static/d58a86281bd1ae4337dab1dd9b256a84/e9ff0/image3.png 180w,
/static/d58a86281bd1ae4337dab1dd9b256a84/f21e7/image3.png 360w,
/static/d58a86281bd1ae4337dab1dd9b256a84/37523/image3.png 720w,
/static/d58a86281bd1ae4337dab1dd9b256a84/302a4/image3.png 1080w,
/static/d58a86281bd1ae4337dab1dd9b256a84/07a9c/image3.png 1440w,
/static/d58a86281bd1ae4337dab1dd9b256a84/11f80/image3.png 2498w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
<li>pid를 이용해서 strace를 활용할 수 있다. 아래는 예시이다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABAUlEQVQY063QO0vDYBTG8Re8Fi+rxQvaKiJ+iAwZElIKQiVjAoUmbxJD2kCyNAnNnqmQWdwclHbx4xX+YkQRFEHwwI+Hh3OmI+4fH+jf9LkdDOj1emiahq7rf2IYBoqiUBQFYrlc4jgOrut+5ldSym9+urFtm/l8jlitVvzniKeXZ0ZyRDyeMInGhMEdnpR4rnxPKfE9n+CNHzT7IAjwfb/heV7Th8MhdV0jytmM/dYu3ZMzLjpdjtuHnJ92uL684uigzV5rh621DbbXNxFC/EpVVcRisSCKIrIsI8szkiQhTVPKsiTPc6bZlDiOCcMQx3WxbLv51wfLspo0TZOqqngFILYYKGgPFtUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image4"
        title="image4"
        src="/static/268cde10d8985a3d49d98cd3c5725b61/37523/image4.png"
        srcset="/static/268cde10d8985a3d49d98cd3c5725b61/e9ff0/image4.png 180w,
/static/268cde10d8985a3d49d98cd3c5725b61/f21e7/image4.png 360w,
/static/268cde10d8985a3d49d98cd3c5725b61/37523/image4.png 720w,
/static/268cde10d8985a3d49d98cd3c5725b61/302a4/image4.png 1080w,
/static/268cde10d8985a3d49d98cd3c5725b61/07a9c/image4.png 1440w,
/static/268cde10d8985a3d49d98cd3c5725b61/9cac8/image4.png 2288w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
<li>c 옵션을 사용하면 애플리케이션에서 사용된 모든 syscall 종류와 summary를 확인할 수 있다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVklEQVQoz6VSyWoCQRTscV9QZ1xRQQUPbhcPIjL3EXTmBwTXiQf1C/yEkFu+uKQqjIQkeMnh8d7r6lddXd3m/fMD4VuI8/mM6/WKy+WC2+2mHIYhjscjDocDTqeTgv1ut1Ps9/tnbDYb3O93GD/wkUqlkMlkUK1WUSgUUC6XlZPJJPL5PNLptPpSqYRcLgdjzJ8xHA5h1us1bNtGpVLBYrFQTZCD8XhcZLFYTGvtdluHsLYs60kU4ZPJBCYIAjQaDdRqNSyXS2WCxWJRG6mcmQSj0UgqfyqLyMfj8RdhvV4Xked5ujZBXjEi5ADrwWAgO14S+r4Px3G00XVd1QTpHUnoLwcSiQS63a76fxNGHvV6Pd3ku3+/PFytVvKLjzGbzVQTzGazylQWDXY6HbRardevvN1u0Ww29YLT6VQDJKdiqiXGH0Bl/X5fPde5h4dHYuj1fD7HA9Rf6X6cXH/mAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image5"
        title="image5"
        src="/static/0db6020c34e74b1aa1168e4e52dd9081/37523/image5.png"
        srcset="/static/0db6020c34e74b1aa1168e4e52dd9081/e9ff0/image5.png 180w,
/static/0db6020c34e74b1aa1168e4e52dd9081/f21e7/image5.png 360w,
/static/0db6020c34e74b1aa1168e4e52dd9081/37523/image5.png 720w,
/static/0db6020c34e74b1aa1168e4e52dd9081/302a4/image5.png 1080w,
/static/0db6020c34e74b1aa1168e4e52dd9081/07a9c/image5.png 1440w,
/static/0db6020c34e74b1aa1168e4e52dd9081/43853/image5.png 2284w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
</ul>
</li>
</ul>
<h4 id="aquasec-tracee" style="position:relative;"><a href="#aquasec-tracee" aria-label="aquasec tracee permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>AquaSec tracee</h4>
<p>AquaSec에서 만든 tracee는 리눅스 커널 트레이싱을 활용하여 컨테이너 환경에서의 시스템 활동을 감지하고 모니터링하는 데 사용된다.</p>
<ul>
<li>eBPF(extended Berkeley Packet Filter) 기술 사용</li>
<li>eBPF와 커널 트레이싱을 활용하여 다양한 시스템 이벤트 및 시스템 콜을 캡처하고, 이를 실시간으로 분석하여 보안 이슈나 이상한 활동을 감지한다.</li>
<li>보통 도커 컨테이너 형태로 OS에 설치하여 활용된다.</li>
</ul>
<h4 id="seccomp" style="position:relative;"><a href="#seccomp" aria-label="seccomp permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Seccomp</h4>
<p>앞서, touch와 같은 간단한 application도 여러가지의 system call을 호출하는 것을 확인할 수 있었다. 리눅스 커널에는 약 435개의 system call이 존재한다.
그러나 실제로 우리가 사용하는 어플리케이션들은 모든 system call을 활용하지는 않으며, 반대로 모든 system call에 접근 가능한 것은 보안의 취약점으로써 attack surface를 줄여주어야 한다.</p>
<ul>
<li>
<p>2016년, ‘Dirty cow’라 불리는 보안 취약점은 ptrace라는 system call을 이용해서 read-only 파일에 쓰기를 하고 root 권한을 탈취할 수 있음을 증명했다.</p>
</li>
<li>
<p>디폴트로는 리눅스 커널은 host/container 환경에서 기동 중인 application에 모든 system call에 대한 접근을 허용한다.</p>
</li>
<li>
<p>Seccomp는 ‘Secure computing’의 약자로서 리눅스 2.6.12부터 리눅스 커널의 기능 중 일부로 포함되었다.</p>
</li>
<li>
<p>Host에 Seccomp가 설치되었는 지 확인하기: Seccomp를 지원하는 리눅스 커널인지 확인하기 위해서는 하기와 같은 명령을 통해 boot config 파일에 seccomp 설정이 존재하는 지 확인함으로써 알 수 있다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">grep -i seccomp /boot/config-$(uname -r)

# CONFIG_SECCOMP = y 라는 결과가 나와야 함</code></pre></div>
</li>
<li>
<p>Container에 Seccomp가 설치되었는 지 확인하기</p>
<ul>
<li>/proc/{pid}/status 를 grep 했을 때 Seccomp 값이 2가 나오면 Seccomp이 선택적으로 syscall을 filter 하고 있음을 의미한다.
<ul>
<li>mode 0 : disabled</li>
<li>mode 1 : strict( 4개의 syscall 만 허용 )</li>
<li>mode 2 : filtered ( Syscall을 선택적으로 필터함 )</li>
</ul>
</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 43.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABqElEQVQoz5WS32riUBDGj3VjQbp44YUQ7XatVApB2VXiP8SEttt2G1tj1lXojU/gvZdeqJGNutE3EHykJPgHfJVvmQNKS0thL358880MhzPDsNGfESzLgmmaMEcmJpMJxuMxbNvGdDrlUK3f739Ir9fDYrEA8zGGI+bDcSCAgBCA8EnA55MTMMb+m2KxCKZd30G/f4Tx8IRGVccvrYZn/Teqtz9RvbmHcfuIu6sfqCgKVEWFoiicSqVygHyhUECn0wFzPQ+r1QqO68BxHHieB9d1uW42G2y3W6zXa95DSp7yFO/zBPXvdjswuZBD5nsG+XwepVKJa7lchqqqyGazkCQJsixzT79IpVJvSKfTSCaTaLfbYALz8/mP/QLXI78foVAIsVgMwWCQ58LhMCKRCNePdkgPM+1Bg67rqNfrqNVqXA3DQLPZRKvVQqPR4PEe8lQnqHffr2kaut0umDWxMJ/NMbNt2H9tzGczfjKDwQBDYjjk8Uvey9HZLJdLsKKcwzcphYv4OaTkJS7iCU7i7CsSZ3F8iZ1CjIqIRqMHRFF8FdN6aB000T/uEmJGpzHhewAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image6"
        title="image6"
        src="/static/1b2ab8a4b6c17855c488002730fea086/37523/image6.png"
        srcset="/static/1b2ab8a4b6c17855c488002730fea086/e9ff0/image6.png 180w,
/static/1b2ab8a4b6c17855c488002730fea086/f21e7/image6.png 360w,
/static/1b2ab8a4b6c17855c488002730fea086/37523/image6.png 720w,
/static/1b2ab8a4b6c17855c488002730fea086/302a4/image6.png 1080w,
/static/1b2ab8a4b6c17855c488002730fea086/07a9c/image6.png 1440w,
/static/1b2ab8a4b6c17855c488002730fea086/8ad1b/image6.png 2320w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
</li>
<li>
<p>Built-in Seccom filter</p>
<ul>
<li>도커는 빌트인으로 seccomp Filter가 있어서 컨테이너가 생성될 때 디폴트로 적용된다. host환경에 seccomp를 지원함을 전제로 한다. 여기에는 기본적으로 60개 정도의 systemcall을 제한하는 정책이 설정되어 있다. ( ptrace 포함)
<ul>
<li><a href="https://github.com/moby/moby/blob/master/profiles/seccomp/default.json">https://github.com/moby/moby/blob/master/profiles/seccomp/default.json</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>SECCOMP profile</p>
<ul>
<li>
<p>Seccomp profile은 3가지 파트로 구성된다.</p>
<ul>
<li>defaultAction : syscalls 파트에서 정의되지 않은 나머지 syscall들을 어떻게 처리할 것인지에대 한 정의. whitelist profile은 기본적으로 <code class="language-text">SCMP_ACT_ALLOW</code>로 설정하고 black list는 <code class="language-text">SCMP_ACT_ERRNO</code>로 설정한다.</li>
<li>architectures : 어떤 아키텍처에서 해당 프로파일이 지원되는 지에 대한 정보</li>
<li>syscalls
<ul>
<li>name : syscall 명칭 나열</li>
<li>action : name에 나열된 syscall에 대해 ALLOW 할 것인지 ERRNO(DENY) 할 것인지에 대한 액션 설정.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>아래는 whitelist/blacklist SECCOMP profile에 대한 예시이다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 43.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB6ElEQVQozz2RvU4bQRRG902w14DN7vyvZ/9siIUDiEgpIlGkC1Bhx6koiXgAUgXxQAFsHoAHAYFAojvRDsjFKUb6dO5350bn5+f8ubjg+vof8/n8gwV3iztub2+5v7/n4eGBq6srfp+dcXn5l8Uy985ivuDm5iZkI2kziuEnfDWk7nuGfc9m31O4jHa7zdHREY+Pj+zu7iJMRt5kywF15hl84K0jjmOm0ymR1Y4v4898HY/ZqWsyZZBCIKWk1WpxeHgYhDuNUCr2x2P2t0eMyhzV5D6yzfCf0wmRlYbNvGCr3yc3Fi0USki00suGT09P7O3tkSQJlc8oncEoyUaSkKQpqZD01mNG3yZESltcUeF8iRQSkaYBLRWddhyEz8/PYeVU6pC1vgiZdIkk7cZ0tydE3fX1MNkazajKKTKLECKw2u4E4cvLS2i42umERpk1YeXcmfBOUsFqJ+b7jwlRr9tDKk3m87BO3c9wRuOMCQ2Pj495fX0NwrW1NZzNKPOKrTxn03tK5/DWEscdfs2mRElvI7RppE1Tmabhs41UtFZWwlEaYbNyI1RSoZVFJgIjJE6q92yrxcnJCVHhcwZVTV2W1GW1ZFgPwmFmsxlvb28cHBzgnKOsSooipygL8uKdsqrQWnN6esp/TlVWxatFPEYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image7"
        title="image7"
        src="/static/6b10b19ecfdf0489735fe8a4492d9566/37523/image7.png"
        srcset="/static/6b10b19ecfdf0489735fe8a4492d9566/e9ff0/image7.png 180w,
/static/6b10b19ecfdf0489735fe8a4492d9566/f21e7/image7.png 360w,
/static/6b10b19ecfdf0489735fe8a4492d9566/37523/image7.png 720w,
/static/6b10b19ecfdf0489735fe8a4492d9566/302a4/image7.png 1080w,
/static/6b10b19ecfdf0489735fe8a4492d9566/07a9c/image7.png 1440w,
/static/6b10b19ecfdf0489735fe8a4492d9566/59058/image7.png 2376w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<ul>
<li>디폴트 profile은 blacklist임을 알 수 있다. 커널 모듈 수정, 시스템 시간 설정, 시스템 재기동, file system 마운팅 등의 다양한 syscall이 제한되어 있다.</li>
</ul>
</li>
<li>
<p>앞서 ‘whalesay’ 컨테이너에서 system time에 대한 변경 명령이 동작하지 않았던 것은 도커에 기본으로 적용된 default.json SECCOMP profile에 의해 <code class="language-text">clock_adjtime</code>, <code class="language-text">clock_settime</code> syscall이 제한되었기 때문이다.</p>
</li>
<li>
<p>custom profile 적용하기</p>
<ul>
<li>하기 예시에서는 mkdir syscall을 blacklist에서 제외한 custom.json을 docker 실행 시에 적용되도록 설정한 것이다.</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4ElEQVQoz4XSzW7aQBQFYK94g3bRDZREjewZe6bGYJNAK5aVuqsJjRpAQqCw4AUapS+QNhFZ9CXS9+qqNuBffnWqGeO0qIuOdHTlWXw6d2Sl2+2i0+ng8/U1ptMH3N/d4WE6xdfbWzz+eMQ8WMD3fXie9xR/5md3vpfFy+Yvz4Oiqip41YFpn0ElBtTjI5wcH+HF82fo9rr49v0el5efMBgM0Ov10O/30b44h/uxDbfjwr0Qsy2/P5y7UBjnMDnHu7cNvG+9QcOugTGOcrmMyWSCtutCURQUCgU5/xsJVmswrSoMw4CmaaCUolQqYTwe4+bLDWzbRqvVQrPZxGm9DqfuoGaaaBCCOqU4oxQ1QqBqGhTGGCjVwU0LNdtGhTNwxiQ4HA6xXq8RRZFMkiRI0xRxHCMMQ0TzOYLZTGa+f2cJincUaVQrcComdF2X4Gg0wna7xWq1OshyuZRwkqaIBB5FWcIwA8Waou6plYFkv3IOCkAkxySYJEjiWDYPgwBBEGCxWPwBNULwmhnghi4bvtyDu91Orp3nn5ZJkqFhKNEnkGgauE5BKQEhFMViUYLiiJZ5/kZzMN6DUZiD4l80K7BsBxZncKwKyMkrjK+uDkDRdrPZHLSUDeMYcRTip7/Ab5OgB7/LwlgsAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image8"
        title="image8"
        src="/static/ff2c7a41467fcfdb4308abd96c124d90/37523/image8.png"
        srcset="/static/ff2c7a41467fcfdb4308abd96c124d90/e9ff0/image8.png 180w,
/static/ff2c7a41467fcfdb4308abd96c124d90/f21e7/image8.png 360w,
/static/ff2c7a41467fcfdb4308abd96c124d90/37523/image8.png 720w,
/static/ff2c7a41467fcfdb4308abd96c124d90/302a4/image8.png 1080w,
/static/ff2c7a41467fcfdb4308abd96c124d90/07a9c/image8.png 1440w,
/static/ff2c7a41467fcfdb4308abd96c124d90/59058/image8.png 2376w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
</li>
<li>
<p>seccomp 사용하지 않기</p>
<ul>
<li><code class="language-text">docker run --security-opt seccomp=unconfined</code> 로 실행하면 seccomp가 적용되지 않는다. 그러나 seccomp가 적용되지 않은 컨테이너도 도커가 기본적으로 system clock등 몇가지 syscall을 막아두고 있어서 seccomp 안 써도 system date 수정은 못한다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="seccomp-in-k8s" style="position:relative;"><a href="#seccomp-in-k8s" aria-label="seccomp in k8s permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Seccomp in K8S</h4>
<p>쿠버네티스에서 Seccomp는 디폴트로 적용되지 않는다. ‘amicontained’를 pod로 실행시켜서 로그를 살펴보면 Seccomp는 disabled이고 blocked syscall도 21개 밖에 없음을 확인할 수 있다.</p>
<ul>
<li>k8s에서는 pod definition에 하기와 같이 설정해야 seccomp가 default profile로 적용된다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 74.44444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACTElEQVQ4y52SW0sbQRTHZ2c3e81lE3PZbEwiSaqJIi0UEqINtbWxVui3UFqTbPDBRwXxxQt+o1x80Q/l069kxRZa8dKBP2cGzvnN/8wccXt7y3g84no65fp6ymQyYTKdMhqNuLm54TXr7u4O8ePnPp+723zd+c6Xrzt0u122t7bodDpsbm5ydHT0rI6Pjzk8PAzNiA8bXbREgYSbZi6VQSoSRQjEf+jk5ASx0f1G3F/Er67iuql/kqSUqKr6pHRdD3PPz88RrWYTIXXSpWXsaIK4ZRGzLWKzaJlIqTzrbAadxbOzM0Sz1UI14yT9Cp4bZ6VUYNHPsVwsUMvnXtTqAzB0+PFTlzl/iaSbxbETOI6LE01hGTZSCCJSRZdaqBcBO2vrCKEQS3mk8lXSpQbpUp1kroxhOb+LdFVDKsqTwIuLC8R6ey0ERp0E3sIq/pv3lLIetUKJpWKZmudRzmRwLftZhyGw1WoiVJ1cuUEyW8S0okihvGp0/gK2wkM2V6DsF8jEoxQzaQpzKTQp0TUNU49gRCJhfKztB+Dl5SWiORsbIfAqb0nmFsKfXvTzVL0sjXmfhUyaTCxGNhEnn3TDt3wS2G63UYWkXHvHfLlBpbpMpbpCpbZKIT9P3IliGjaWaWPpJjHLJmrZ2IaJqqlomoZhGCHw6uoKUa/X/9ymOgjdRQgTocYQRhKhWPcS90WOooTj9Nhbnp6eImazs7e3R9Dv09/fZzBTrxcq6PUY9vsMB4N7BQHBIGAYDAlm+yBgOBxycHDA7u4u4/GYX6Rcw2CzSCmVAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image9"
        title="image9"
        src="/static/c7dca1a8145d1ad25bdd402060627fda/37523/image9.png"
        srcset="/static/c7dca1a8145d1ad25bdd402060627fda/e9ff0/image9.png 180w,
/static/c7dca1a8145d1ad25bdd402060627fda/f21e7/image9.png 360w,
/static/c7dca1a8145d1ad25bdd402060627fda/37523/image9.png 720w,
/static/c7dca1a8145d1ad25bdd402060627fda/302a4/image9.png 1080w,
/static/c7dca1a8145d1ad25bdd402060627fda/07a9c/image9.png 1440w,
/static/c7dca1a8145d1ad25bdd402060627fda/2a333/image9.png 1484w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
<li>host에 있는 custom profile을 적용하는 방법
<ul>
<li>먼저 모든 노드의 <code class="language-text">/var/lib/kubelet/seccomp/</code> 경로 하위에 seccomp profile을 위치시킨다.</li>
<li>하기와 같이 type을 Localhost로 설정하면 되는데 이 때 profile 파일의 경로는 위의 경로 하위의 상대 경로를 입력해주면 된다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABuklEQVQoz63SzW7aQBDAcX9RY6+xsQ2iiCZtUiW99cShVA3FEJsT7SPwRCUowFMktQ/cUcrHE/AqSCAu/4qtSntI1Ubq4aedGa1mR7urfLkZMLwZMhwOub29ZTweMxqNZDyZTBgMBkynU2azGfd3d2RZSpqmZAdZxtc0Jc0y6ZArD98emM/n0mKxYLlcHq1WK1lbr9fU63U0PUcxLOP6AZZToGDbhJ6L5wiElUfTdZTtdstud7B71H6/Z7PZ0O/3edd4TyfpEnVimq2Ij80r4nZEp9WiefWBRqOBEl136PU+86nXo9vtEkUR7Xb76GeeJIkUx7GUJDFxknB9zBO6SYKiWwFFv4SqKCj/Qz44IfB9CpaJyOdlUVXVI0V9YkNDhITPX1GqnuH55T9Oqiqq9A9NNU4u69RO3/Dy9ALfC/Esm0A4kmvZCDOPpqjoqvb3prrpUj1/SxhUqBR9hCXwbEHZdQmdAr7jyDhwHHwhKAobO29im8/whE3BtsgZxm9NDZtS7TVnlTKh6z56qq6p6JomGfqPVVNVDF2XsbzrX/sVSi8uCWsXFKvnCL+C5fiYliOnyR0+6xMe5Ttuc1jDULc9fgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image10"
        title="image10"
        src="/static/3a85d7b194c928cbe47e1bcb66bf10dc/37523/image10.png"
        srcset="/static/3a85d7b194c928cbe47e1bcb66bf10dc/e9ff0/image10.png 180w,
/static/3a85d7b194c928cbe47e1bcb66bf10dc/f21e7/image10.png 360w,
/static/3a85d7b194c928cbe47e1bcb66bf10dc/37523/image10.png 720w,
/static/3a85d7b194c928cbe47e1bcb66bf10dc/302a4/image10.png 1080w,
/static/3a85d7b194c928cbe47e1bcb66bf10dc/07a9c/image10.png 1440w,
/static/3a85d7b194c928cbe47e1bcb66bf10dc/14586/image10.png 2314w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
</ul>
</li>
<li><code class="language-text">grep syscall /var/log/syslog</code>을 하면 실행된 syscall 번호와 pid등의 정보가 나온다.</li>
<li>우분투에서는 <code class="language-text">grep -w {syscall번호} /usr/include/asm/unistd_64.h</code> 명령을 실행하면 syscall 번호가 어떤 syscall name에 매핑되는지 알 수 있다.</li>
<li>tracee을 아래와 같이 활용하면 새로 생성된 ‘test-audit’이란 pod가 있다고 가정할 때 해당 pod가 어떤 syscall을 호출했는 지 알 수 있다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABUUlEQVQY002P626CQBCFF+Sisivi/ZKKqIVECxKl0jQ8gZek9i8aAybU93+B0zAmTX9McnbPnG9m2Ff6jTzLUfwUuFwuuN/veDweuF6vSNMURVEgz3NkWYbb7Ybz+YzT6YTD4YDj8UhV6v1+T5oFfoAkSbCL3pF8JvjYxQjXIaIowna7xWq1wnK5RBAEiOMYvu9js9nQ/2w2w3Q6hffqwl+9Ye7MwGzbRuD7aHABx3FgigYkxsAFh2maYIxRKYpCfqkty8JoNIIkSfSuaVUMBoNn73yxQLheo2214LouOp0OqpqOdruNbrdLTZqmwTAMeJ5H4DI8mUygqCr5wuA0jHMOtiiBYUjAMlACNVUjYK/Xo4CqqqjX6+TLsox+v09A9R9wPB4/NxwOh89TuYD9MkHLtKApCoQQfyeXW+m6TqHyzGazSYMrlQr5vGbQQjKT8AvKgqYWOdjrKAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image11"
        title="image11"
        src="/static/2f04d5a456b4ef09b051dd85e164597d/37523/image11.png"
        srcset="/static/2f04d5a456b4ef09b051dd85e164597d/e9ff0/image11.png 180w,
/static/2f04d5a456b4ef09b051dd85e164597d/f21e7/image11.png 360w,
/static/2f04d5a456b4ef09b051dd85e164597d/37523/image11.png 720w,
/static/2f04d5a456b4ef09b051dd85e164597d/302a4/image11.png 1080w,
/static/2f04d5a456b4ef09b051dd85e164597d/07a9c/image11.png 1440w,
/static/2f04d5a456b4ef09b051dd85e164597d/0330c/image11.png 2458w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
</ul>
<h3 id="10-apparmor" style="position:relative;"><a href="#10-apparmor" aria-label="10 apparmor permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. AppArmor</h3>
<p>AppArmor는 Linux에서 내장되어 있고 프로세스에게 리소스에 대한 권한을 제한할 수 있도록 지원한다.</p>
<ul>
<li><code class="language-text">systemctl status apparmor</code> 로 Linux에 설치되어있는 지 확인 가능</li>
<li>k8s에서 apparmor를 쓰기 위해서는 컨테이너가 구동될 모든 노드에 apparmor 커널 모듈이 Load되어 있어야 한다.
<ul>
<li><code class="language-text">cat /sys/module/apparmor/parameters/enabled</code>의 결과가 Y여야 한다.</li>
<li><code class="language-text">cat /sys/kernel/security/apparmor/profiles</code>에는 load된 profile 정보가 명시되어 있다.</li>
</ul>
</li>
</ul>
<h4 id="apparmor-profile" style="position:relative;"><a href="#apparmor-profile" aria-label="apparmor profile permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>AppArmor Profile</h4>
<ul>
<li>Profile 예시
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABz0lEQVQoz42RTY/SUBiFCwgUaynSSi1lKsNIRiezph3GUYe6UBOQ8BH+xLhlJRgyRVmzIISEAP+G8mnZsOLjnxzTOynRGBNu8uQ95743996cl+r1emg0GjAMAz+bP9A0mjDu71Gv1fC9XkftWw2tVgvT6RTL5RLz+RyLxQKz2ewv7UDls1+QOIkjqSRwmTjHRTyJc+UMr1+8RPLkFLIoQZIkRKNRyLJMaiwWIyiKAlEUEQgE4PV6wTAMqMz7WyRPz3D56gLycwkRXkAkLEB6JoIPPQVFUUfjcrlAff74CXwwBEkQyUUhhgVLM+AePwFDP7zs4PP54Pf7SXW0g+3JD9frNcamSTKycXKx8/plWbAsC6vVimD3J5PJP5imSRiPx6D2+z222y12ux2pjrb3N5vNAdsfs6hqtYpCoUCoVCool8soFosolUrI5XLIZrOEfD6PbreL4XCIwWCAfr+P0Wh08J1OB+12G5Su6+AFgWBnwLIsqVyIQzAYfNAcB5qm4fF4SPhut5sM4E8Ow7m+SiPMcojHFETCPNEcw4Lx0fA/8pJD9kCOnvbXuzvcXL+BfpvBh4yOdzdviddUFVeqhlQqRVBVFZqm/Re7n06n8RvZKZEb0gwdDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image12"
        title="image12"
        src="/static/ce0f1162820ca82c1209e9c778295b69/37523/image12.png"
        srcset="/static/ce0f1162820ca82c1209e9c778295b69/e9ff0/image12.png 180w,
/static/ce0f1162820ca82c1209e9c778295b69/f21e7/image12.png 360w,
/static/ce0f1162820ca82c1209e9c778295b69/37523/image12.png 720w,
/static/ce0f1162820ca82c1209e9c778295b69/302a4/image12.png 1080w,
/static/ce0f1162820ca82c1209e9c778295b69/07a9c/image12.png 1440w,
/static/ce0f1162820ca82c1209e9c778295b69/9c701/image12.png 1774w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABD0lEQVQY03WOTWrCUBSFXzPL30saIWhNLd2ANqIhde5YRPOCE0VwBw6yIEEFf1bhmtSB8JX3oE5KBx/nnnMvhytOpxPH49FwOBw4n89Pv91u2e127Pd7NpsNl8uFx+PB/X433G43w/V6fXqRZRndbpfvwYA8z+lnfXTW6/WMfqUpaZrSbrcZDofM53MWi4VhuVwaVqsV0+mU9XqNsG2bQEqkL4miCMdxCMOQMAiQUuK5Lr7nm1nnrutiWRZCiD90Oh1EHEZ8vL2TxA2SuE4zrtNqNGnUYiI/4DNpEb/WCGwPz3F5+afsWahfVUWBKpR5uyxLlFIUOlOK2WxmVO8mkwnj8dio9r/o29FoRFVV/AB3tb4lWtjSiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image13"
        title="image13"
        src="/static/548b23f408bd46099ef011d05a2be7c8/37523/image13.png"
        srcset="/static/548b23f408bd46099ef011d05a2be7c8/e9ff0/image13.png 180w,
/static/548b23f408bd46099ef011d05a2be7c8/f21e7/image13.png 360w,
/static/548b23f408bd46099ef011d05a2be7c8/37523/image13.png 720w,
/static/548b23f408bd46099ef011d05a2be7c8/302a4/image13.png 1080w,
/static/548b23f408bd46099ef011d05a2be7c8/07a9c/image13.png 1440w,
/static/548b23f408bd46099ef011d05a2be7c8/e92cd/image13.png 1778w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
<li>Profile mode
<ul>
<li>enforce : profile의 rule을 application에 적용</li>
<li>complain : profile의 rule을 application에 실제 적용하지는 않고 logging만 함</li>
<li>unconfined : profile을 application에 적용하지 않고 logging도 안함.</li>
</ul>
</li>
</ul>
<h4 id="apparmor-profile-생성하기" style="position:relative;"><a href="#apparmor-profile-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-label="apparmor profile 생성하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apparmor profile 생성하기</h4>
<ul>
<li>Apparmor-utils 패키지 설치하기</li>
<li>위를 통해 설치된 aa-genprof 커맨드 활용하여 profile 생성
<ul>
<li><code class="language-text">aa-genprof /root/add_data.sh</code> 와 같은 명령을 통해 어플리케이션에 대한 apparmor에서 제공하는 일련의 질문에 대해서 모두 답하면 profile이 그에 상응하게 enforce모드로 생성된다.</li>
<li><code class="language-text">aa-status</code>로 확인 가능</li>
</ul>
</li>
<li>Profile 파일을 apparomor에 load하는 방법
<ul>
<li><code class="language-text">apparmor_parser /etc/apparmor.d/root.add_data.sh</code></li>
</ul>
</li>
<li>profile disable 하는 법
<ul>
<li><code class="language-text">apparmor_parser -R /etc/apparmor.d/root.add_data.sh</code></li>
<li><code class="language-text">ln -s /etc/apparmor.d/root.add_data.sh /etc/apparmor.d/disable</code></li>
</ul>
</li>
</ul>
<h4 id="apparmor-in-k8s" style="position:relative;"><a href="#apparmor-in-k8s" aria-label="apparmor in k8s permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>AppArmor in K8S</h4>
<ul>
<li>AppArmor kernel module/profile이 모든 노드에서 load되어야 하고 컨테이너 런타임에서 지원해야 한다.</li>
<li>ubuntu-sleeper라는 간단한 pod에 apparmor-deny-write라는 aa profile을 적용하려면..
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA4klEQVQY063Py0rDUBSF4UNOeklOz8VcFFoEB47iJPdqSkl0EqmY93+bX1Ktc7GDj8XasNlscTp98DlNTNPEOI70fc8wDH82782ETe7RaoMnBOIa4u0ju90DkYuJrWO1WuNJHykXSH+2RJ67/90v6XkspMSX8jdnwppboniLNinaJOhNhLMp1sRYm+Bu7jA6wur4Z55gbYpaBzilsErhNgoThugwQPgqwroUs1oSzFf++3KxP3J8e+f10PHSNJR5Tl0UtFXFoW3p2pamLHmua6oiZ19XdE1DVRRkWcZTlp3z4gu/MZkxAbxMMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image14"
        title="image14"
        src="/static/947a0e1ba18f7cfa352cbc4c8233cce5/37523/image14.png"
        srcset="/static/947a0e1ba18f7cfa352cbc4c8233cce5/e9ff0/image14.png 180w,
/static/947a0e1ba18f7cfa352cbc4c8233cce5/f21e7/image14.png 360w,
/static/947a0e1ba18f7cfa352cbc4c8233cce5/37523/image14.png 720w,
/static/947a0e1ba18f7cfa352cbc4c8233cce5/302a4/image14.png 1080w,
/static/947a0e1ba18f7cfa352cbc4c8233cce5/07a9c/image14.png 1440w,
/static/947a0e1ba18f7cfa352cbc4c8233cce5/b4472/image14.png 2468w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
</ul>
<h3 id="linux-capabilities" style="position:relative;"><a href="#linux-capabilities" aria-label="linux capabilities permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Linux capabilities</h3>
<p>리눅스 커널은 과거에는 privileged process, unprivileged process로 나뉘었지만 현재는 privileged process라도 Capability로 권한을 나눈다.</p>
<ul>
<li>어떤 app에서 어떤 capability가 필요한지 확인하는 방법 : getcap
<ul>
<li>프로그램은 경로를, process는 pid로 capability를 확인한다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB6UlEQVQoz3VSS2uaURT8Fq7UoOAjGJ/oJhpfK0VFXEl9pLpypUalIupGcKliqKBC/0DqRnChERTRBCFd+lvqo9EfMeWcoqSFLoY5M3cunHvuEQrVL4hEIvh8f49oNIpkMolwOIxQKASPxwOv13vB/7TP54PNZkO73Ybw/ekJnU4H/X6fudfrMbrdLhqNBprN5gWtVuuCf/16vY7n52cIP39tsd1usdvtcDgc/sLpdMLxeMT7+ztryhAov9/vGR89ygmfEhGoVCqYTCaYzWYYDAbc3t7CYrFAp9PBaDTCbrczk6ZzvV7PdxQKBZRKJa6vryESiVCpVCD8eHvDaDTCZDLhlsfjMRaLBebzOdez2Qzr9RrL5RIvLy94fX3FarXCdDrlO5QhHg6H2Gw2EB6/fUWtVuMZVKtVFItF5PN5PDw8MOdyOWSzWdYfQWfn80KhgFQqhcFgAIF+U61WQ6vVXtqXy+WQSCQMqqVSKcRiMWQyGXtXV1fsnZkygiAgk8lAiMfjPDOaE+Hu7o7hdDpZOxwOuN1urmk1XC4Xe1arlZlAWZprqVT60yF1dh66RqPBzc0Nd0w4+1TTJWL6GMpQljzS9IJ0Og2hXC7zIicSCcRiMV5Sv99/QSAQYI/4rM8eaeJgMMivon38DdjomaowY5pOAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image15"
        title="image15"
        src="/static/aa3c0f728b7d428015224addd3fefc25/37523/image15.png"
        srcset="/static/aa3c0f728b7d428015224addd3fefc25/e9ff0/image15.png 180w,
/static/aa3c0f728b7d428015224addd3fefc25/f21e7/image15.png 360w,
/static/aa3c0f728b7d428015224addd3fefc25/37523/image15.png 720w,
/static/aa3c0f728b7d428015224addd3fefc25/302a4/image15.png 1080w,
/static/aa3c0f728b7d428015224addd3fefc25/07a9c/image15.png 1440w,
/static/aa3c0f728b7d428015224addd3fefc25/37563/image15.png 2228w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
</ul>
</li>
<li>Docker 런타임 환경에서는 14가지의 capability만을 디폴트로 지닌다.</li>
<li>k8s pod 설정에서 securityContext 절에서 capability를 추가, 제거할 수 있다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 65.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB90lEQVQ4y52Ta0sbQRSGZ2bX2WR3s7fsromJF9Te6Fc/hPSSCgW/tM2lMRUrNhRFiPiHRBIM4r/yhwjiU3YtgZZK0x54OGcYzjvn5TBiMh5zdXXFZDJmennJ9fU148kkzxcXF9zc3JDF3d0d9/f3j5LF7e0totF8RWv7Pc0372i+3abVavG62aTRaLC1tcVuv8/JyQlHR0d/5Pj4OL8/ODhgOp0iTNunENawbY/AixBC/DfD4RDhlSvE9ackS+vEUYyhJFIqDMPIMU1zVj+GZVm54OnpKcLUFuHSBn66jO84LEUBgeOQ+D4raUypWPjrZJlolkejEcLKrFbWKNguC1YRUxcQUv6T1V8Es6LoBkS1J3hJnTSpEJZKFLQmdB0Sz2PhZ8PcglJK4pUXhJU1qoHH81qVWhTmdgPHxjQUhlIopeYUVAZRbZNk9SVBXMX3PNKoTD1JcCwL27JYr6QErovW1qOC+VIeJlSUylWCxVXCyjpBdSPHKQWzJjmH5VwwOygpMc0F4pVnJPVN4nLKcn0Nz3VZDH1Ktp3blUrm+Xe01rng2dnZw4Szl1QBrV1MIQi1JnUcysUixpzbzn6OaLfbZHTaHb4ODtnf/85eb8DhYI/RtyGHu3t0P3bofPjEl06fz70e3W6XXq83o9/vs7Ozw/n5OT8AwW55P00C8DsAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image16"
        title="image16"
        src="/static/1a354f14d9278cc18b9e0aa38025a2a6/37523/image16.png"
        srcset="/static/1a354f14d9278cc18b9e0aa38025a2a6/e9ff0/image16.png 180w,
/static/1a354f14d9278cc18b9e0aa38025a2a6/f21e7/image16.png 360w,
/static/1a354f14d9278cc18b9e0aa38025a2a6/37523/image16.png 720w,
/static/1a354f14d9278cc18b9e0aa38025a2a6/302a4/image16.png 1080w,
/static/1a354f14d9278cc18b9e0aa38025a2a6/01a87/image16.png 1288w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></li>
</ul></div></div><div class="post-navigator"><div class="post-navigator-card-wrapper"><a class="post-card prev" href="/cks3/"><div class="direction">이전 글</div><div class="title">[CKS] System Hardening 1</div></a></div><div class="post-navigator-card-wrapper"><a class="post-card next" href="/read-center-church8/"><div class="direction">다음 글</div><div class="title">[독서 모임] 도시를 사랑할 수 있을까 - 센터처치 Week8</div></a></div></div><div class="utterances"></div></main><footer class="page-footer-wrapper"><p class="page-footer">© <!-- -->2023<!-- --> <a href="https://github.com/jjunyong">Jplus</a> powered by<a href="https://github.com/zoomKoding/zoomkoding-gatsby-blog"> zoomkoding-gatsby-blog</a></p></footer><div class="dark-mode-button-wrapper"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium dark-mode-button css-1yxmbwk" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeLarge dark-mode-icon css-6flbmm" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="DarkModeIcon"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg></button></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/cks4/";window.___webpackCompilationHash="9d7679893ef1a67c81c8";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-f196834924f88edde8fc.js"],"app":["/app-82aac73f1d5a7f751fb8.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-12b5d8159c7e67968cd6.js"],"component---src-pages-404-js":["/component---src-pages-404-js-29258485103e835516fd.js"],"component---src-pages-about-js":["/component---src-pages-about-js-7ef65d31f4e471233a87.js"],"component---src-pages-index-js":["/component---src-pages-index-js-326b652c9ec950d6439a.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-2b0521eff6d4e80c8984.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-addefa15e14ce4af818f.js"]};/*]]>*/</script><script src="/polyfill-f196834924f88edde8fc.js" nomodule=""></script><script src="/app-82aac73f1d5a7f751fb8.js" async=""></script><script src="/framework-de157c6b30d4790e4e81.js" async=""></script><script src="/webpack-runtime-c0fc7ea0494a482fbd6e.js" async=""></script></body></html>