---
emoji: ğŸ§¢
title: 'Docker ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°'
date: '2024-02-21 11:00:00'
author: jjunyong
tags: network
categories: Linux í´ë¼ìš°ë“œ
---

- super user ê¶Œí•œ ì—†ì´ docker ì‚¬ìš©í•˜ê¸°

```bash
sudo usermod -aG docker {ê³„ì •ëª…}
```

- dockerì—ì„œ ì»¨í…Œì´ë„ˆ ìƒì„±í•˜ê³  ë‚´ë¶€ë¡œ ë“¤ì–´ê°€ê¸°

```bash
docker run --rm -it ubuntu:16.04 /bin/bash

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ë¦¬ëˆ…ìŠ¤ ë²„ì „ í™•ì¸
cat /etc/issue
```

### ì»¨í…Œì´ë„ˆë€?

- ì»¨í…Œì´ë„ˆëŠ” ë…ë¦½ëœ ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì´ë‹¤.
- ì»¨í…Œì´ë„ˆëŠ” ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ì´ë‹¤.
  ![image1](./image1.png)

### Docker êµ¬ì¡°

![image2](./image2.png)

- ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ê°€ 1ë²ˆì¸ daemon í”„ë¡œì„¸ìŠ¤ì˜ í˜•íƒœë¡œ dockerdëŠ” êµ¬ë™ëœë‹¤.
- docker CLI ëª…ë ¹ì€ dockerdì— ì „ë‹¬ëœë‹¤. ì „ë‹¬í•˜ëŠ” ë°©ì‹ì€ /var/run/docker.sock
- containerdê°€ container runtimeì´ë©° /run/containerd/containerd.sock ì„ í†µí•´ì„œ dockerdì™€ í†µì‹ í•œë‹¤.
- docker ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ CLIëª…ë ¹ì„ ì‚¬ìš©í•˜ê³ ì í•˜ë©´ ì „ì²´ ì»¨í…Œì´ë„ˆì— ëŒ€í•œ ì •ë³´ë¥¼ dockerdë¥¼ í†µí•´ì„œ ì•Œì•„ë‚´ì•¼ í•˜ê¸° ë•Œë¬¸ì— í˜¸ìŠ¤íŠ¸ì˜ /var/run/docker.sockë¥¼ ë„ì»¤ ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡ ë§ˆìš´íŠ¸ë˜ì–´ì•¼ í•œë‹¤.
- dockerd, docker CLI í”„ë¡œì„¸ìŠ¤ëŠ” ì•„ë˜ì™€ ê°™ì´ tmpfs íŒŒì¼ ì‹œìŠ¤í…œ ì¦‰, ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°„ docker.sockê³¼ í†µì‹ í•¨ìœ¼ë¡œì¨ ë¹ ë¥¸ I/O ì†ë„ë¥¼ ê°€ì ¸ê°„ë‹¤.
  ![image3](./image3.png)

### Docker in Docker

- docker CLI, dockerd, containerd, containerd-shim ê¸°ë™ ì¤‘ì¸ì§€ì— ëŒ€í•œ í™•ì¸
- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ dockerì‚¬ìš© ì‹¤ìŠµ ( docker in docker )
  ![image4](./image4.png)

---

## ë„ì»¤ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°

- docker0ë¼ëŠ” ë¸Œë¦¿ì§€/ìŠ¤ìœ„ì¹˜ ì¥ë¹„ë¥¼ swì ìœ¼ë¡œ êµ¬í˜„í•˜ê³  ìˆë‹¤ê³  ë³´ë©´ ë¨.
- ì»¨í…Œì´ë„ˆëŠ” ë„¤íŠ¸ì›ì—ì„œ ê°œë³„ ì»´í“¨í„°ë¡œ ë³´ë©´ ë˜ëŠ”ë°, network interfaceê°€ hostì— 1ê°œê¸° ë•Œë¬¸ì— ê°€ìƒì˜ vethë¥¼ í†µí•´ì„œ ì»¨í…Œì´ë„ˆë“¤ì— ê°ê°ì˜ network interfaceë¥¼ ë¶€ì—¬í•˜ê²Œ ë¨
  ![image5](./image5.png)
- ë„ì»¤ ë„¤íŠ¸ì›Œí¬ í™•ì¸í•˜ê¸°

```bash
docker network ls
```

- ë‹¤ì–‘í•œ ì»¨í…Œì´ë„ˆì™€ docker0 ë¸Œë¦¿ì§€ ì—°ê²°í™•ì¸í•˜ê¸°
  ![image6](./image6.png)

- ì»¨í…Œì´ë„ˆì˜ gatewayì¸ docker0 ipì£¼ì†Œ í™•ì¸í•˜ê¸°
  ![image7](./image7.png)

- ì»¨í…Œì´ë„ˆ ë‚´ì˜ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ eth0 í™•ì¸í•˜ê¸°
  ![image8](./image8.png)

- ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆì˜ ë„¤íŠ¸ì›Œí¬ ipì£¼ì†Œ í™•ì¸í•˜ê¸°
  ![image9](./image9.png)

- ì»¨í…Œì´ë„ˆ ê°„ì˜ ë„¤íŠ¸ì› í†µì‹  í…ŒìŠ¤íŠ¸
  ![image10](./image10.png)

- ë…ë¦½ëœ ë„¤íŠ¸ì›Œí¬ ìƒì„± í›„ 2ê°œì˜ ì»¨í…Œì´ë„ˆ í†µì‹ 
  ![image11](./image11.png)
  ![image12](./image12.png)

- ë…ë¦½ëœ ë„¤íŠ¸ì›Œí¬ ìƒì„± í›„ 2ê°œì˜ ì»¨í…Œì´ë„ˆ í†µì‹  ë¬¸ì œí•´ê²°
  ![image13](./image13.png)
  ![image14](./image14.png)

- ìƒˆë¡œìš´ ë…ë¦½ëœ ë„¤íŠ¸ì›Œí¬ vs ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ë¹„êµ
  ![image15](./image15.png)
  ![image16](./image16.png)
