{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/spring-boot-aws-environment/",
    "result": {"data":{"cur":{"id":"c2fcb249-3189-5828-b2e1-d04bc2273100","html":"<h2 id=\"1-aws에서-프리티어로-ec2와-rds-발급하기\" style=\"position:relative;\"><a href=\"#1-aws%EC%97%90%EC%84%9C-%ED%94%84%EB%A6%AC%ED%8B%B0%EC%96%B4%EB%A1%9C-ec2%EC%99%80-rds-%EB%B0%9C%EA%B8%89%ED%95%98%EA%B8%B0\" aria-label=\"1 aws에서 프리티어로 ec2와 rds 발급하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. AWS에서 프리티어로 EC2와 RDS 발급하기</h2>\n<h3 id=\"1-ec2-인스턴스-발급\" style=\"position:relative;\"><a href=\"#1-ec2-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EB%B0%9C%EA%B8%89\" aria-label=\"1 ec2 인스턴스 발급 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) EC2 인스턴스 발급</h3>\n<p>AWS 에 들어가서 EC2 인스턴스 생성하기로 가서 생성하면 된다. 프리티어로 발급 가능한 인스턴스를 발급 받았다.</p>\n<p>발급 시 신경 써 주어야 할 부분은 프리티어에서 사용 가능한 최대 스토리지 설정(30GB)과 보안그룹에서 규칙을 설정하는 것이다.</p>\n<p>보안그룹을 설정하지 않으면 생성한 EC2 서버로 모든 통신이 불가능하기 때문에 필요한 port와 사용자에 대해 꼭 설정해주어야 함!</p>\n<p>나는 Front/Back-end를 위해 각각 3000,8080포트를 모든 사용자에게 허용하고 http,https를 통한 접근 허용을 위해 80,443 포트도 열어두었다.</p>\n<h3 id=\"2-ec2-ssh-접속-테스트\" style=\"position:relative;\"><a href=\"#2-ec2-ssh-%EC%A0%91%EC%86%8D-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"2 ec2 ssh 접속 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) EC2 ssh 접속 테스트</h3>\n<p>Windows에선 putty 설치해서, Mac에선 ssh 커맨드라인 툴을 이용해서 ssh priavte key를 사용해서 접속하면 된다.\n계정명은 ubuntu로 초기 로그인이 되며 su 명령어를 통해 root로 유저를 변경하여 root 및 ubuntu 계정의 비밀번호를 내가 원하는 대로 변경해두는 것이 좋다.</p>\n<h3 id=\"3-rds-발급\" style=\"position:relative;\"><a href=\"#3-rds-%EB%B0%9C%EA%B8%89\" aria-label=\"3 rds 발급 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) RDS 발급</h3>\n<p>rds 발급도 ‘데이터베이스 생성’을 클릭하여 간단하게 생성 가능하다. MySQL을 선택하여 생성하면 되고, 보안규칙에 MySQL port인 3306을 허용시켜주면 된다.</p>\n<h3 id=\"4-dbeaver에서-rds로-접속-테스트\" style=\"position:relative;\"><a href=\"#4-dbeaver%EC%97%90%EC%84%9C-rds%EB%A1%9C-%EC%A0%91%EC%86%8D-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"4 dbeaver에서 rds로 접속 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4) DBeaver에서 RDS로 접속 테스트</h3>\n<p>Server Host에는 엔드포인트 값을, Port에는 3306, Username/Password에는 RDS 생성 시 입력한 값을 넣으면 된다. 여기서 헷갈렸던 부분이 RDS db 인스턴스의 db식별자 명을 예를 들어 ‘abc’라고 했는데 Database이름에 계속 ‘abc’를 입력하고 test connection을 하니 연결이 되지 않았다. 알고 보니 <strong>Database이름은 비워둔 상태에서 접속한 후에 DB를 ‘abc’라는 이름으로 생성</strong>해주어야 했던 것임.</p>\n<p>이로써, aws의 도움을 받아 간단하게 백엔드를 위한 인프라 설정은 끝났다.</p>\n<hr>\n<h2 id=\"2-spring-boot-프로젝트-생성-및-db-연동\" style=\"position:relative;\"><a href=\"#2-spring-boot-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1-%EB%B0%8F-db-%EC%97%B0%EB%8F%99\" aria-label=\"2 spring boot 프로젝트 생성 및 db 연동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Spring boot 프로젝트 생성 및 DB 연동</h2>\n<h3 id=\"1-프로젝트-생성\" style=\"position:relative;\"><a href=\"#1-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1\" aria-label=\"1 프로젝트 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) 프로젝트 생성​</h3>\n<p>IntelliJ에서 ‘New project’ - Spring intializr에서 원하는 jdk, spring boot 버전, 빌드 도구(maven,gradle) 등 선택해서 프로젝트 생성하면 된다.(너무 불친절한가…)</p>\n<h3 id=\"2-jpa-사용을-위해-gradle에-jpa-의존성-추가\" style=\"position:relative;\"><a href=\"#2-jpa-%EC%82%AC%EC%9A%A9%EC%9D%84-%EC%9C%84%ED%95%B4-gradle%EC%97%90-jpa-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%B6%94%EA%B0%80\" aria-label=\"2 jpa 사용을 위해 gradle에 jpa 의존성 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) JPA 사용을 위해 gradle에 JPA 의존성 추가</h3>\n<p>Mybatis와 같은 sqlmapper를 사용해서 DB와 연동할 수도 있지만 Java진영의 ORM 표준인 JPA를 사용하여 DB와 연동할 것임.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dependencies {\nimplementation 'mysql:mysql-connector-java'\nimplementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n}</code></pre></div>\n<h3 id=\"3-applicationproperties\" style=\"position:relative;\"><a href=\"#3-applicationproperties\" aria-label=\"3 applicationproperties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) application.properties</h3>\n<p>Mysql을 사용하기 위한 드라이버 설정, datasource 설정, DB계정 설정을 해주면 됨.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># MySQL 설정\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n# Datasource 설정(aws)\nspring.datasource.url=jdbc:mysql://{aws RDS endpoint값}:3306/{DB 스키마명}?useSSL=false&amp;useUnicode=true&amp;serverTimezone=Asia/Seoul\n# DB username\nspring.datasource.username=&lt;username>\n# DB password\nspring.datasource.password=&lt;password></code></pre></div>\n<hr>\n<h2 id=\"3spring-boot-어플리케이션-ec2-배포하기\" style=\"position:relative;\"><a href=\"#3spring-boot-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-ec2-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0\" aria-label=\"3spring boot 어플리케이션 ec2 배포하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.Spring boot 어플리케이션 EC2 배포하기</h2>\n<h3 id=\"1-ssh로-접속하여-git-clone하기\" style=\"position:relative;\"><a href=\"#1-ssh%EB%A1%9C-%EC%A0%91%EC%86%8D%ED%95%98%EC%97%AC-git-clone%ED%95%98%EA%B8%B0\" aria-label=\"1 ssh로 접속하여 git clone하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) ssh로 접속하여 git clone하기</h3>\n<p>1에서 ssh 접속 테스트를 성공했다면 무리없이 EC2에 접속해서 2에서 생성한 Spring boot 프로젝트의 git repo를 clone하자. 2에서 생성한 프로젝트를 git에 push하는 것은 설명하지 않았지만, 구글링하면 바로 나온다.</p>\n<p>아니면 winscp나 Filezilla와 같은 sftp툴을 사용해서 로컬에서 빌드한 jar파일을 EC2에 업로드 해도 된다.</p>\n<p><strong>EC2에 git과 jdk가 설치되어있지 않다면 git clone하기 전에 해주어야 함</strong></p>\n<h3 id=\"2-소스코드-빌드-및-빌드된-jar-실행하기\" style=\"position:relative;\"><a href=\"#2-%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EB%B9%8C%EB%93%9C-%EB%B0%8F-%EB%B9%8C%EB%93%9C%EB%90%9C-jar-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0\" aria-label=\"2 소스코드 빌드 및 빌드된 jar 실행하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 소스코드 빌드 및 빌드된 jar 실행하기</h3>\n<ul>\n<li>\n<p>gradlew 실행 권한 부여</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo chmod 777 ./gradlew</code></pre></div>\n</li>\n<li>\n<p>빌드하기</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ./gradlew build</code></pre></div>\n</li>\n<li>\n<p>실행하기</p>\n<p>빌드하기에서BUILD SUCCESSFUL이 되었다면 build/libs/ 아래의 SNAPSHOT.jar 파일을 실행시켜주자. Spring boot는 톰캣 서버가 내장 되어 있어서 jar만 실행 시켜주면 마침내 Spring boot 서버가 가동된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ java -jar Helloworld-0.0.1-SNAPSHOT.jar</code></pre></div>\n</li>\n</ul>\n<hr>\n<p>추가로 웹 브라우저 상에서 확인을 원한다면 EC2에서 public IP주소를 찾아 아래와 같이 실행하면 Helloworld!라고 나오는 것을 확인 가능하다.\n물론, Spring boot 소스코드에서 /test로 접근시 Restconroller에서 ‘Helloworld!’라는 String을 return하도록 구현이 되어있다면 ㅎㅎ</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#1-aws%EC%97%90%EC%84%9C-%ED%94%84%EB%A6%AC%ED%8B%B0%EC%96%B4%EB%A1%9C-ec2%EC%99%80-rds-%EB%B0%9C%EA%B8%89%ED%95%98%EA%B8%B0\">1. AWS에서 프리티어로 EC2와 RDS 발급하기</a></p>\n<ul>\n<li><a href=\"#1-ec2-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EB%B0%9C%EA%B8%89\">1) EC2 인스턴스 발급</a></li>\n<li><a href=\"#2-ec2-ssh-%EC%A0%91%EC%86%8D-%ED%85%8C%EC%8A%A4%ED%8A%B8\">2) EC2 ssh 접속 테스트</a></li>\n<li><a href=\"#3-rds-%EB%B0%9C%EA%B8%89\">3) RDS 발급</a></li>\n<li><a href=\"#4-dbeaver%EC%97%90%EC%84%9C-rds%EB%A1%9C-%EC%A0%91%EC%86%8D-%ED%85%8C%EC%8A%A4%ED%8A%B8\">4) DBeaver에서 RDS로 접속 테스트</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-spring-boot-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1-%EB%B0%8F-db-%EC%97%B0%EB%8F%99\">2. Spring boot 프로젝트 생성 및 DB 연동</a></p>\n<ul>\n<li><a href=\"#1-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1\">1) 프로젝트 생성​</a></li>\n<li><a href=\"#2-jpa-%EC%82%AC%EC%9A%A9%EC%9D%84-%EC%9C%84%ED%95%B4-gradle%EC%97%90-jpa-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%B6%94%EA%B0%80\">2) JPA 사용을 위해 gradle에 JPA 의존성 추가</a></li>\n<li><a href=\"#3-applicationproperties\">3) application.properties</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3spring-boot-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-ec2-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0\">3.Spring boot 어플리케이션 EC2 배포하기</a></p>\n<ul>\n<li><a href=\"#1-ssh%EB%A1%9C-%EC%A0%91%EC%86%8D%ED%95%98%EC%97%AC-git-clone%ED%95%98%EA%B8%B0\">1) ssh로 접속하여 git clone하기</a></li>\n<li><a href=\"#2-%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EB%B9%8C%EB%93%9C-%EB%B0%8F-%EB%B9%8C%EB%93%9C%EB%90%9C-jar-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0\">2) 소스코드 빌드 및 빌드된 jar 실행하기</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"1. AWS에서 프리티어로 EC2와 RDS 발급하기 1) EC2 인스턴스 발급 AWS 에 들어가서 EC2 인스턴스 생성하기로 가서 생성하면 된다. 프리티어로 발급 가능한 인스턴스를 발급 받았다. 발급 시 신경 써 주어야 할 부분은 프리티어에서 사용 가능한 최대 스토리지 설정(30GB)과 보안그룹에서 규칙을 설정하는 것이다. 보안그룹을 설정하지 않으면 생성한 EC2 서버로 모든 통신이 불가능하기 때문에 필요한 port와 사용자에 대해 꼭 설정해주어야 함! 나는 Front/Back-end를 위해 각각 3000,8080포트를 모든 사용자에게 허용하고 http,https를 통한 접근 허용을 위해 80,443 포트도 열어두었다. 2) EC2 ssh 접속 테스트 Windows에선 putty 설치해서, Mac에선 ssh 커맨드라인 툴을 이용해서 ssh priavte key를 사용해서 접속하면 된다.\n계정명은 ubuntu로 초기 로그인이 되며 su 명령어를 통해 root로 유저를 변경하여 roo…","frontmatter":{"date":"February 04, 2022","title":"Spring boot 개발환경 설정 (gradle,JPA,MySQL,EC2,RDS)","categories":"Spring","author":"jjunyong","emoji":"🧢"},"fields":{"slug":"/spring-boot-aws-environment/"}},"next":{"id":"24a3b461-7734-58bd-b6f8-fd563441bf60","html":"<p>Spring을 이용해서 개발을 시작한다고 할 때 대부분의 개발자들은 Spring boot를 이용할 것이다.\nSpring boot를 활용하게 되면 Spring 사용 시 필요한 여러가지 <del>귀찮은</del> configuration들을 자동으로 설정해줄 뿐만 아니라 개발자비즈니스 로직 개발에 집중할 수 있도록 여러가지 기능을 제공한다.</p>\n<h2 id=\"spring-boot란-무엇인가\" style=\"position:relative;\"><a href=\"#spring-boot%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\" aria-label=\"spring boot란 무엇인가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring boot란 무엇인가?</h2>\n<ul>\n<li>\n<p>간략하게 정의하면 Spring boot는 Spring framework 을 더 쉽게 사용할 수 있게 해주는 framework로 보면 된다.\nSpring은 사용하기 위해 필요한 설정 들이 생각보다 복잡한데, Spring boot는 기본적으로 이러한 설정들을 모두 제공하기 때문에,\n개발자 입장에서는 초기 개발 환경을 셋팅하는 것이 매우 용이해진다.</p>\n</li>\n<li>\n<p>Spring boot 공식 문서는 다음과 같이 말한다.\n<br></p>\n<blockquote>\n<p>Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can “just run”.</p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"spring-boot는-무엇을-해주는가\" style=\"position:relative;\"><a href=\"#spring-boot%EB%8A%94-%EB%AC%B4%EC%97%87%EC%9D%84-%ED%95%B4%EC%A3%BC%EB%8A%94%EA%B0%80\" aria-label=\"spring boot는 무엇을 해주는가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring boot는 무엇을 해주는가?</h2>\n<h3 id=\"1-dependency-관리\" style=\"position:relative;\"><a href=\"#1-dependency-%EA%B4%80%EB%A6%AC\" aria-label=\"1 dependency 관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Dependency 관리</h3>\n<ul>\n<li>\n<p>스프링부트를 사용하면, dependency를 pom.xml 또는 build.gradle에 직접 추가 해주어햐 하는 Spring과 달리 spring-boot-starter-web를 추가하면\n기본적인 웹 개발에 필요한 dependency를 알아서 추가 해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-boot-starter-web<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span></code></pre></div>\n</li>\n<li>\n<p>그리고 dependency의 버전을 따로 작성해주지 않아도 사용 중인 스프링 부트 버전에 호환되는 dependancy로 자동관리 해준다.</p>\n</li>\n</ul>\n<h3 id=\"2-configuration\" style=\"position:relative;\"><a href=\"#2-configuration\" aria-label=\"2 configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Configuration</h3>\n<ul>\n<li>\n<p><strong>Auto Configuration</strong></p>\n<p>Spring boot에서는 @SpringBootApplication이라는 하나의 어노테이션을 통해 스프링 어플리케이션이 필요한 아래와 같은 설정을 알아서 해준다.</p>\n<ul>\n<li>\n<p>@ComponentScan</p>\n<p>: @Component, @Service, @Repository, @Controller 등의 어노테이션을 스캔하여 Bean으로 등록해 준다.</p>\n</li>\n<li>\n<p>@EnableAutoConfiguration</p>\n<p>: External Libraries -> spring-boot-autoconfigure -> META_INF -> spring.factories에 존재하는\n사전에 정의한 라이브러리들 중 아래 조건을 만족시키는 것을 Bean으로 등록해 주는 어노테이션이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span><span class=\"token punctuation\">(</span>proxyBeanMethods <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ConditionalOnWebApplication</span><span class=\"token punctuation\">(</span>type <span class=\"token operator\">=</span> <span class=\"token class-name\">Type</span><span class=\"token punctuation\">.</span>SERVLET<span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ConditionalOnClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token class-name\">Servlet</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">DispatcherServlet</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">WebMvcConfigurer</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ConditionalOnMissingBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebMvcConfigurationSupport</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>편리한 Configuration</strong></p>\n<ul>\n<li>\n<p>Spring은 configuration 설정이 길 뿐만 아니라 어노테이션 및 빈 등록을 해주어야 한다.\n하지만 Spring boot에서는 application.yml 또는 build.gradle(또는 pom.xml)에 의존성을 한 줄 추가함으로써 해결 가능하다.</p>\n</li>\n<li>\n<p>가령 Thymeleaf를 Spring에서 사용한다고 하면 아래와 같은 설정이 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token annotation punctuation\">@EnableWebMvc</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MvcWebConfig</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">WebMvcConfigurer</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Autowired</span>\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">ApplicationContext</span> applicationContext<span class=\"token punctuation\">;</span>\n\n  <span class=\"token annotation punctuation\">@Bean</span>\n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringResourceTemplateResolver</span> <span class=\"token function\">templateResolver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">SpringResourceTemplateResolver</span> templateResolver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpringResourceTemplateResolver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    templateResolver<span class=\"token punctuation\">.</span><span class=\"token function\">setApplicationContext</span><span class=\"token punctuation\">(</span>applicationContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    templateResolver<span class=\"token punctuation\">.</span><span class=\"token function\">setPrefix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/WEB-INF/views/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    templateResolver<span class=\"token punctuation\">.</span><span class=\"token function\">setSuffix</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".html\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> templateResolver<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Bean</span>\n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringTemplateEngine</span> <span class=\"token function\">templateEngine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">SpringTemplateEngine</span> templateEngine <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpringTemplateEngine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    templateEngine<span class=\"token punctuation\">.</span><span class=\"token function\">setTemplateResolver</span><span class=\"token punctuation\">(</span><span class=\"token function\">templateResolver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    templateEngine<span class=\"token punctuation\">.</span><span class=\"token function\">setEnableSpringELCompiler</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> templateEngine<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">configureViewResolvers</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ViewResolverRegistry</span> registry<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ThymeleafViewResolver</span> resolver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ThymeleafViewResolver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    resolver<span class=\"token punctuation\">.</span><span class=\"token function\">setTemplateEngine</span><span class=\"token punctuation\">(</span><span class=\"token function\">templateEngine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    registry<span class=\"token punctuation\">.</span><span class=\"token function\">viewResolver</span><span class=\"token punctuation\">(</span>resolver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>그런데 Spring boot에서는 아래와 같이 build.gradle 파일에 의존성 하나만 추가 해주면 Thymeleaf를 사용 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"gradle\"><pre class=\"language-gradle\"><code class=\"language-gradle\">implementation &#39;org.springframework.boot:spring-boot-starter-thymeleaf</code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"3-편리한-배포--내장-tomcat\" style=\"position:relative;\"><a href=\"#3-%ED%8E%B8%EB%A6%AC%ED%95%9C-%EB%B0%B0%ED%8F%AC--%EB%82%B4%EC%9E%A5-tomcat\" aria-label=\"3 편리한 배포  내장 tomcat permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 편리한 배포 : 내장 Tomcat</h3>\n<p>Spring boot는 Spring과 달리 Tomcat을 내장하고 있기 때문에 war가 아닌 Jar파일 을 통해 간편하게 배포가 가능하다.</p>\n<h3 id=\"4-devtools-제공\" style=\"position:relative;\"><a href=\"#4-devtools-%EC%A0%9C%EA%B3%B5\" aria-label=\"4 devtools 제공 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Devtools 제공</h3>\n<p>Spring Boot에서 제공하는 Devtools는 아래와 같은 기능 들을 통해 개발 생산성을 높여준다.</p>\n<ul>\n<li>Automatic Restart\n클래스 패스에 있는 파일이 변경될 때마다 어플리케이션을 자동으로 재시작 해주어 소스가 수정 후 개발자가 재실행하는 불필요한 과정을 줄여준다.</li>\n<li>Live Reload\nhtml, css, js와 같은 정적 자원이 수정되면 새로고침 없이 바로 적용되게 된다.</li>\n<li>Property Defaults\nThymeleaf 등에서 사용하는 cache의 기본값을 false로 설정할 수 있다. 소스 수정 시 캐시로 인해 반영이 안 되는 것을 방지하기 위한 설정임</li>\n</ul>\n<hr>\n<h3 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h3>\n<p>Spring boot를 통해 개발하면 Spring으로 개발하는 것과 비교해 위와 같이 많은 장점이 있기 때문에, Spring의 원리를 파악했다면 Spring boot로 개발하는 것을 추천한다.</p>","frontmatter":{"date":"February 02, 2022","title":"[Spring] Spring boot는 무엇을 해주는가? 스프링 부트를 쓰는 이유","categories":"Spring","author":"jjunyong","emoji":"🌸"},"fields":{"slug":"/why-spring-boot/"}},"prev":{"id":"a4372864-4ae0-5bc1-8534-1f5c8d770858","html":"<h2 id=\"http-status-code-제어\" style=\"position:relative;\"><a href=\"#http-status-code-%EC%A0%9C%EC%96%B4\" aria-label=\"http status code 제어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Http Status Code 제어</h2>\n<p>REST API를 통해 User를 생성하는 API를 만드는 상황을 가정해보자.\n좀 더 나은 API 설계를 고려한다면 단순히 User를 생성만 하는 것에서 그칠 것이 아니라 요청자에게 response로 결과 데이터를 반환해주어야 할 것이다.\n가령 사용자에게 요청 값을 반환해 주기 위해 ServletUriComponentsBuilder 라는 클래스를 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/users\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">createUser</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">User</span> user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">User</span> savedUser <span class=\"token operator\">=</span> <span class=\"token class-name\">UserService</span><span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">URI</span> location <span class=\"token operator\">=</span> <span class=\"token class-name\">ServletUriComponentsBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromCurrentRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/{id}\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">buildAndExpand</span><span class=\"token punctuation\">(</span>savedUser<span class=\"token punctuation\">.</span>ge\n        <span class=\"token punctuation\">.</span><span class=\"token function\">toUri</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token punctuation\">.</span><span class=\"token function\">created</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이렇게 하면 클라이언트는 Header로부터 200을 받는 것이 아니라 201 created 값을 반환받을 수 있게 되며\nheader의 Key값 중 location값에서 POST의 URI value를 알 수 있다.</p>\n<ul>\n<li>여기선 <a href=\"http://localhost:8080/users/10\">http://localhost:8080/users/10</a> 이 될 것이다.</li>\n</ul>\n<p>이렇듯 200 OK로만 보내는 것이 아니라 CRUD에 따라, 그리고 여러가지 상황에 따라 서로 다른 HTTP status code값으로 응답해주는 것이 좋고, location값을 반환 해 줌에 따라 클라이언트는 자기가 방금 생성한 user의 id값도 알 수 있게 되므로 자신이 생성한 user의 id를 서버에 물어보는 불필요한 traffic낭비를 방지할 수 있다.</p>\n<ul>\n<li>\n<p>참고로 HTTP status 코드는 대역대로 어떤 상태인지를 대략적으로 알 수 있다.</p>\n<ul>\n<li>\n<p>2xx : 정상 동작( OK )</p>\n</li>\n<li>\n<p>4xx : 클라이언트의 잘못된 요청에 대한 것</p>\n</li>\n<li>\n<p>5xx : 서버의 문제</p>\n</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>이와 같이 REST API 설계 시 다양한 Http status code 를 활용하여 상황에 맞는 response로 요청자에게 응답해주는 것이 보다 나은 API를 만들기 위해\n매우 중요한 부분이다.</p>\n</blockquote>\n<hr>\n<h2 id=\"예외-핸들링\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%99%B8-%ED%95%B8%EB%93%A4%EB%A7%81\" aria-label=\"예외 핸들링 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예외 핸들링</h2>\n<p>: <strong>@ResponseStatus, @ControllerAdvice(+@RestControllerAdvice)</strong></p>\n<p>REST API에서 request에 대한 예외가 발생 시 핸들링 하는 방법에 대해서 알아보자.</p>\n<p>아래와 같이 로직 처리 시 user가 존재하지 않을 때 UserNotFoundException을 throw하도록 하고,</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>user <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UserNotFoundException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ID[%s] not found\"</span><span class=\"token punctuation\">,</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>UserNotFoundException 클래스를 따로 만들어 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">\b<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UserNotFoundException</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">RunTimeException</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserNotFoundException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이렇게 구현 후 클라이언트에서 <a href=\"http://localhost:8080/users/1000\">http://localhost:8080/users/1000</a> 를 다시 호출하면,</p>\n<p>500 Internal server error와 함께 message, trace값들을 response받을 수 있는데 이 때 2가지 문제가 있다.</p>\n<ul>\n<li><strong>trace값에 문제가 되는 코드들이 그대로 노출되는 보안 상의 이슈가 있을 수 있다.</strong></li>\n<li><strong>정확히 어떤 에러인지에 대한 HTTP 코드를 명확하게 해줄 필요가 있다.</strong></li>\n</ul>\n<p>이 2가지 문제를 해결하기 위해 먼저 상황에 맞게 HTTP code를 반환하도록 설정해보자.\n위의 경우는 서버 측의 문제라기 보다는 클라이언트가 없는 사용자를 잘못 요청한 경우에 해당 함으로 Exception클래스를 아래와 같이 바꿔서 404 Not Found로 response 해주도록 변경하자. 이렇게 하면 클라이언트가 없는 user를 요청했을 때</p>\n<blockquote>\n<p>404, ID[1000] Not Found</p>\n</blockquote>\n<p>로 응답받게 되는 것을 확인할 수 있다.</p>\n<h3 id=\"responsestatus-사용\" style=\"position:relative;\"><a href=\"#responsestatus-%EC%82%AC%EC%9A%A9\" aria-label=\"responsestatus 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@ResponseStatus 사용</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span>NOT_FOUND<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 404 NOT FOUND\b</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UserNotFoundException</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">RunTimeException</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserNotFoundException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이렇듯 @ResponseStatus 를 사용하면 원하는 예외 상황에 대해서 HTTP 상태코드와 error message를 설정하는 것이 가능하다. 그러나 각 예외 상황에 대해서 예외클래스를 설정해주어야 한다는 점, 그리고 response의 payload를 변경할 수 없다는 한계가 있다.</p>\n<h3 id=\"controlleradvicerestcontrolleradvice-사용\" style=\"position:relative;\"><a href=\"#controlleradvicerestcontrolleradvice-%EC%82%AC%EC%9A%A9\" aria-label=\"controlleradvicerestcontrolleradvice 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@ControllerAdvice(@RestControllerAdvice) 사용</h3>\n<p>@RestController + @ControllerAdvice인 @RestControllerAdvice 어노테이션을 사용하여 예외처리하는 방법에 대해서 알아보자. 이 방법은 Spring5에서 가장 많이 사용되고 있는 방법이다.</p>\n<p>exception 패키지 아래에 GloabalExceptionHandler와 ErrorResponse 클래스를 아래와 같이 설정하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RestControllerAdvice</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GlobalExceptionHandler</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ResponseEntityExceptionHandler</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">handleAllExceptions</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exceptions</span> ex<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Webrequest</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ExceptionResponse</span> exceptionResponse <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExceptionResponse</span><span class=\"token punctuation\">(</span>\n            <span class=\"token class-name\">LocalDateTime</span><span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ex<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getDescription</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token punctuation\">(</span>exceptionResponse<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span>INTERNAL_SERVER_ERROR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">handleUserNotFoundExceptions</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exceptions</span> ex<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Webrequest</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ExceptionResponse</span> exceptionResponse <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExceptionResponse</span><span class=\"token punctuation\">(</span>\n            <span class=\"token class-name\">LocalDateTime</span><span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ex<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getDescription</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token punctuation\">(</span>exceptionResponse<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span>NOT_FOUND<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token annotation punctuation\">@AllArgsConstructor</span>\n<span class=\"token annotation punctuation\">@NoArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">LocalDateTime</span> timestamp<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> message<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> details<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이렇게 하게 되면 GlobalExceptionHandler가 어플리케이션 전역에서 발생하는 예외상황에 대해서 예외처리를 하게 되고, 개발자 입장에서는 예외처리하고자 하는 케이스가 늘어날 때마다 해당 클래스에 메소드만 UserNotFoundExceptions 메소드와 같이 추가해주면 된다.</p>\n<blockquote>\n<p>만약에 설정되지 않은 예외가 발생 시 handleAllExceptions메소드가 500으로 response해주게 될 것이다.</p>\n</blockquote>\n<p>그리고 ErrorReponse 클래스를 설정함으로써 @ResponseStatus만 사용했던 때와 달리 reponseBody를 커스터마이징 할 수 있게 되었을 뿐만 아니라 trace가 response에 노출되던 보안상의 이슈까지 극복할 수 있게 되었다.</p>\n<blockquote>\n<p>만약에 trace를 response해주고 싶은 예외상황이 있다면 해당 메소드에서만 응답하도록 설정해주면 될 것이다.</p>\n</blockquote>\n<hr>\n<p>참고자료</p>\n<ul>\n<li>\n<p><a href=\"https://mangkyu.tistory.com/204\">https://mangkyu.tistory.com/204</a>, <a href=\"https://mangkyu.tistory.com/205\">https://mangkyu.tistory.com/205</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/MangKyu/InterviewSubscription/tree/master/src/main/java/com/mangkyu/employment/interview/erros\">https://github.com/MangKyu/InterviewSubscription/tree/master/src/main/java/com/mangkyu/employment/interview/erros</a></p>\n</li>\n<li>\n<p><a href=\"https://bcp0109.tistory.com/303\">https://bcp0109.tistory.com/303</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/edowon/restful-web-service/blob/master/src/main/java/com/example/restfulwebservice/user/UserNotFoundException.java\">https://github.com/edowon/restful-web-service/blob/master/src/main/java/com/example/restfulwebservice/user/UserNotFoundException.java</a></p>\n</li>\n</ul>","frontmatter":{"date":"February 04, 2022","title":"[REST API] HTTP Status Code 제어와 예외 해들링(Exception handling)","categories":"WEB","author":"jjunyong","emoji":"😌"},"fields":{"slug":"/rest-httpcode-exception/"}},"site":{"siteMetadata":{"siteUrl":"https://steadyandslow.com","comments":{"utterances":{"repo":"jjunyong/jjunyong.github.io"}}}}},"pageContext":{"slug":"/spring-boot-aws-environment/","nextSlug":"/why-spring-boot/","prevSlug":"/rest-httpcode-exception/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}