{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/aws_jasypt/",
    "result": {"data":{"cur":{"id":"0844a804-5826-55ab-b4cf-d3ace9b96070","html":"<p>Spring boot 환경에서 AWS S3를 연동해서 사용하려고 하면, application.yml 또는 application.properties에 아\n래와 같이 accessKey, secretKey값을 설정해줄 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">cloud<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span>accessKey<span class=\"token operator\">=</span>accessKey값\ncloud<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span>secretKey<span class=\"token operator\">=</span>secretKey값</code></pre></div>\n<br>\n<p>그런데 이렇게 설정을 하게 되면 AWS의 accessKey, secretKey값이 깃헙에 노출되는 문제가 발생한다.</p>\n<p>이미 나는 그걸 모르고 별일 없겠지라는 안일한 생각으로 깃헙에 코드를 푸시했다가 <strong>이틀 만에 해킹(ㅠㅠ)</strong> 당하는 일을 겪어야 했다.</p>\n<p><del>이틀 만에 80 달러 치를 썼더라 해커놈 ㅡㅡ</del></p>\n<p>그러니 반드시 Jasypt를 활용해서 AWS key값을 암호화해서 올리시길 바란다.</p>\n<h2 id=\"jasypt\" style=\"position:relative;\"><a href=\"#jasypt\" aria-label=\"jasypt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Jasypt</h2>\n<p>: Java Simplified Encryption으로 암호화를 위한 Library이다. 보통 프로퍼티에 노출되는 중요 정보들을 암호화 해주는 용도로 사용한다.</p>\n<h3 id=\"1-의존성-설정--buildgradle-\" style=\"position:relative;\"><a href=\"#1-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%84%A4%EC%A0%95--buildgradle-\" aria-label=\"1 의존성 설정  buildgradle  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 의존성 설정 ( build.gradle )</h3>\n<p>나는 gradle을 사용하기 때문에 아래와 같이 간단한게 jasypt를 사용하기 위한 의존성을 설정했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dependencies {\n\timplementation 'com.github.ulisesbocchio:jasypt-spring-boot-starter:3.0.3'\n}</code></pre></div>\n<h3 id=\"2-custom-vm-option에-password-설정\" style=\"position:relative;\"><a href=\"#2-custom-vm-option%EC%97%90-password-%EC%84%A4%EC%A0%95\" aria-label=\"2 custom vm option에 password 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Custom vm Option에 password 설정</h3>\n<p>jasypt를 이용해서 encrypt, decrypt를 실행 시 반드시 password를 설정해야 되는데, 이 password는 다른 사람이 알게되면\n결국 jasypt를 이용해서 복호화가 가능하므로 절대 외부로 노출되서는 안된다.</p>\n<p><strong>따라서 jvm option에 추가 해준다.</strong> Intellij에서는 [Help]-[Edit custom VM Options] 에 아래행을 추가해주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token operator\">-</span><span class=\"token class-name\">Djasypt_password</span><span class=\"token operator\">=</span>password값</code></pre></div>\n<br>\n<h3 id=\"3-config-클래스-설정\" style=\"position:relative;\"><a href=\"#3-config-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%84%A4%EC%A0%95\" aria-label=\"3 config 클래스 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Config 클래스 설정</h3>\n<p>의존성과 vm option 설정이 끝났다면 이제 코드를 작성해보자.</p>\n<ul>\n<li>\n<p>JasyptConfig 클래스를 @Configuration 로 만들어주고, Bean을 등록해준다.</p>\n</li>\n<li>\n<p>bean name을 설정해서 jasypt가 application.properties 파일에서 bean을 참조할 수 있도록  설정한다.</p>\n</li>\n<li>\n<p>jvm option에서 설정한 jasypt_password값을 System.getProperty(“jasypt_password”) 명령을 통해 가져와서 password로 설정한다.</p>\n</li>\n</ul>\n<br>\n<p>JasyptConfig.java</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JasyptConfig</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> encryptKey<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"stgOnyouEncryptor\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//원하는 이름 아무거나</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">StringEncryptor</span> <span class=\"token function\">stringEncryptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\n        <span class=\"token class-name\">PooledPBEStringEncryptor</span> encryptor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PooledPBEStringEncryptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">SimpleStringPBEConfig</span> config <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleStringPBEConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> jasyptPassword <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jasypt_password\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        config<span class=\"token punctuation\">.</span><span class=\"token function\">setPassword</span><span class=\"token punctuation\">(</span>jasyptPassword<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        config<span class=\"token punctuation\">.</span><span class=\"token function\">setAlgorithm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PBEWithMD5AndDES\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        config<span class=\"token punctuation\">.</span><span class=\"token function\">setPoolSize</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        config<span class=\"token punctuation\">.</span><span class=\"token function\">setSaltGeneratorClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"org.jasypt.salt.RandomSaltGenerator\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        config<span class=\"token punctuation\">.</span><span class=\"token function\">setStringOutputType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"base64\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        encryptor<span class=\"token punctuation\">.</span><span class=\"token function\">setConfig</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> encryptor<span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>application.properties</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">jasypt<span class=\"token punctuation\">.</span>encryptor<span class=\"token punctuation\">.</span>bean <span class=\"token operator\">=</span> stgOnyouEncryptor <span class=\"token comment\">// JasyptConfig의 bean name과 일치해야함</span></code></pre></div>\n<p>이렇게 하면 jasypt를 위한 암호화 설정은 끝났다.</p>\n<h3 id=\"4-테스트-코드를-통해-암호화된-key값-얻기\" style=\"position:relative;\"><a href=\"#4-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C%EB%A5%BC-%ED%86%B5%ED%95%B4-%EC%95%94%ED%98%B8%ED%99%94%EB%90%9C-key%EA%B0%92-%EC%96%BB%EA%B8%B0\" aria-label=\"4 테스트 코드를 통해 암호화된 key값 얻기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 테스트 코드를 통해 암호화된 key값 얻기</h3>\n<p>아래와 같이 테스트 코드를 작성 후 실행하면 accessKey, secretKey에 대해서 ‘jasypt_password’ 값으로 암호화 한 key값을 각각 얻을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@SpringBootTest</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JasyptConfigTest</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">jasyptTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//given</span>\n        <span class=\"token class-name\">String</span> accessKey <span class=\"token operator\">=</span> <span class=\"token string\">\"accessKey값\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> secretKey <span class=\"token operator\">=</span> <span class=\"token string\">\"secretKey값\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">StandardPBEStringEncryptor</span> jasypt <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StandardPBEStringEncryptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> jasyptPassword <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jasypt_password\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">setPassword</span><span class=\"token punctuation\">(</span>jasyptPassword<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">setAlgorithm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PBEWithMD5AndDES\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">String</span> encryptedAccessKey <span class=\"token operator\">=</span> jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>accessKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accessKey 암호화 내용: \"</span> <span class=\"token operator\">+</span> encryptedAccessKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> decryptedAccessKey <span class=\"token operator\">=</span>  jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>encryptedAccessKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accessKey 복호화 내용: \"</span> <span class=\"token operator\">+</span> decryptedAccessKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">String</span> encryptedSecretKey <span class=\"token operator\">=</span> jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>secretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"secretKey 암호화 내용: \"</span> <span class=\"token operator\">+</span> encryptedSecretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> decryptSecretKey <span class=\"token operator\">=</span>  jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>encryptedSecretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accessKey 복호화 내용: \"</span> <span class=\"token operator\">+</span> decryptSecretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>accessKey<span class=\"token punctuation\">,</span> <span class=\"token function\">is</span><span class=\"token punctuation\">(</span><span class=\"token function\">equalTo</span><span class=\"token punctuation\">(</span>decryptedAccessKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>secretKey<span class=\"token punctuation\">,</span> <span class=\"token function\">is</span><span class=\"token punctuation\">(</span><span class=\"token function\">equalTo</span><span class=\"token punctuation\">(</span>decryptSecretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>System.out.println 해서 암호화된 key값을 얻은 뒤에 application.properties에 암호화된 값으로 설정하면 된다.\n이 값을 ENC로 감싸주면 알아서 jasypt가 알아서 복호화를 시켜준다고 하는데,(예를 들어 ENC(암호화값) 이런식으로..)\n나는 그게 잘 안되서 그냥 암호화된 값을 application.properties에 입력하고, awsConfig 클래스에서 직접 복호화했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">cloud<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span>accessKey<span class=\"token operator\">=</span>암호화된accessKey값\ncloud<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span>secretKey<span class=\"token operator\">=</span>암호화된secretKey값</code></pre></div>\n<br>\n<h3 id=\"5-aws-config-클래스에서-적용\" style=\"position:relative;\"><a href=\"#5-aws-config-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%97%90%EC%84%9C-%EC%A0%81%EC%9A%A9\" aria-label=\"5 aws config 클래스에서 적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. AWS config 클래스에서 적용</h3>\n<p>나는 아래와 같이 AWS access, secret Key를 사용하는 쪽 코드에서 직접 복호화 해주었다.\n만약에 ENC()로 감싸는 방법이 잘 적용된다면 ‘여기서부터’ ~ ‘여기까지’ 코드는 필요없이 jasypt에서\naccessKey, secretKey 값을 불러올 때 알아서 복호화된 값으로 불러와서 변수에 저장해줄 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AwsS3Config</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${cloud.aws.credentials.accesskey}\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> accessKey<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${cloud.aws.credentials.secretkey}\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> secretKey<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${cloud.aws.region.static}\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> region<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AmazonS3Client</span> <span class=\"token function\">amazonS3Client</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token comment\">//여기서부터 </span>\n        <span class=\"token class-name\">StandardPBEStringEncryptor</span> jasypt <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StandardPBEStringEncryptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> jasyptPassword <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jasypt_password\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">setPassword</span><span class=\"token punctuation\">(</span>jasyptPassword<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">setAlgorithm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PBEWithMD5AndDES\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">String</span> decryptAccessKey <span class=\"token operator\">=</span> jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>accessKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> decryptSecretKey <span class=\"token operator\">=</span> jasypt<span class=\"token punctuation\">.</span><span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>secretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">//여기까지 </span>\n        <span class=\"token class-name\">BasicAWSCredentials</span> awsCreds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BasicAWSCredentials</span><span class=\"token punctuation\">(</span>decryptAccessKey<span class=\"token punctuation\">,</span> decryptSecretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">AmazonS3Client</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">AmazonS3ClientBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">standard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">withRegion</span><span class=\"token punctuation\">(</span>region<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">withCredentials</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AWSStaticCredentialsProvider</span><span class=\"token punctuation\">(</span>awsCreds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<br>\n<h3 id=\"6-빌드-시-옵션-추가\" style=\"position:relative;\"><a href=\"#6-%EB%B9%8C%EB%93%9C-%EC%8B%9C-%EC%98%B5%EC%85%98-%EC%B6%94%EA%B0%80\" aria-label=\"6 빌드 시 옵션 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 빌드 시 옵션 추가</h3>\n<p>5번까지 진행하면 로컬에서 jasypt를 사용하기 위한 환경설정은 끝난다.\n그러나 빌드 하여 배포를 하려면 Intellij run시 jvm option 추가 해줬던 것처럼 아래와 같이 jasypt_password 환경변수를 추가해주어야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">java -jar -Djasypt_password<span class=\"token operator\">=</span>password값 app.jar </code></pre></div>\n<br>\n<p>나는 github에 푸시하면 Github action이 Dockerfile 읽어서 자동으로 빌드하게 설정해두었기 때문에 아래와 같이 dockerfile에 추가해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">FROM openjdk:11-jdk\nARG <span class=\"token assign-left variable\">JAR_FILE</span><span class=\"token operator\">=</span>build/libs/onyou-0.0.1-SNAPSHOT.jar\nCOPY <span class=\"token variable\">${JAR_FILE}</span> app.jar\nENTRYPOINT <span class=\"token punctuation\">[</span><span class=\"token string\">\"java\"</span>,<span class=\"token string\">\"-jar\"</span>,<span class=\"token string\">\"-Djasypt_password=password값\"</span>,<span class=\"token string\">\"/app.jar\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<hr>\n<p>지금까지 jasypt를 이용해서 소중한 aws key값을 보호하는 방법을 알아보았다.\n비단 aws key값 뿐만 아니라 DB 정보를 암호화하는데도 사용할 수 있을 것이다.</p>\n<hr>\n<h3 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h3>\n<ul>\n<li><a href=\"https://velog.io/@znftm97/Jasypt-%EC%82%AC%EC%9A%A9%EB%B2%95-%ED%94%84%EB%A1%9C%ED%8D%BC%ED%8B%B0-%ED%8C%8C%EC%9D%BC-%EC%95%94%ED%98%B8%ED%99%94\">https://velog.io/@znftm97/Jasypt-%EC%82%AC%EC%9A%A9%EB%B2%95-%ED%94%84%EB%A1%9C%ED%8D%BC%ED%8B%B0-%ED%8C%8C%EC%9D%BC-%EC%95%94%ED%98%B8%ED%99%94</a></li>\n<li><a href=\"https://junyharang.tistory.com/m/191\">https://junyharang.tistory.com/m/191</a></li>\n<li><a href=\"https://blusky10.tistory.com/404\">https://blusky10.tistory.com/404</a></li>\n<li><a href=\"https://kim-jong-hyun.tistory.com/50\">https://kim-jong-hyun.tistory.com/50</a></li>\n</ul>","excerpt":"Spring boot 환경에서 AWS S3를 연동해서 사용하려고 하면, application.yml 또는 application.properties에 아\n래와 같이 accessKey, secretKey값을 설정해줄 것이다. 그런데 이렇게 설정을 하게 되면 AWS의 accessKey, secretKey값이 깃헙에 노출되는 문제가 발생한다. 이미 나는 그걸 모르고 별일 없겠지라는 안일한 생각으로 깃헙에 코드를 푸시했다가 이틀 만에 해킹(ㅠㅠ) 당하는 일을 겪어야 했다. 이틀 만에 80 달러 치를 썼더라 해커놈 ㅡㅡ 그러니 반드시 Jasypt를 활용해서 AWS key값을 암호화해서 올리시길 바란다. Jasypt : Java Simplified Encryption으로 암호화를 위한 Library이다. 보통 프로퍼티에 노출되는 중요 정보들을 암호화 해주는 용도로 사용한다. 1. 의존성 설정 ( build.gradle ) 나는 gradle을 사용하기 때문에 아래와 같이 간단한게 jasypt를 …","frontmatter":{"date":"April 15, 2022","title":"[AWS] AWS key값을 Jasypt를 이용해서 보호하자","categories":"AWS","author":"jjunyong","emoji":"🧢"},"fields":{"slug":"/aws_jasypt/"}},"next":{"id":"82e6428f-f8dc-5910-93fa-96947ef11565","html":"<h2 id=\"1-jpa에서-프록시란-무엇인가\" style=\"position:relative;\"><a href=\"#1-jpa%EC%97%90%EC%84%9C-%ED%94%84%EB%A1%9D%EC%8B%9C%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\" aria-label=\"1 jpa에서 프록시란 무엇인가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. JPA에서 프록시란 무엇인가?</h2>\n<h3 id=\"1-emfind-vs-emgetreference\" style=\"position:relative;\"><a href=\"#1-emfind-vs-emgetreference\" aria-label=\"1 emfind vs emgetreference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) em.find vs em.getReference</h3>\n<p>em.find를 하게 되면 JPA가 실제 entity 객체를 반환하지만,</p>\n<p>em.getReference를 하게 되면 DB조회를 미루는 ‘프록시’ entity 객체를 반환한다.</p>\n<p>프록시 객체는 실제 Entity 타깃 객체는 가지고 있지 않고, id값만 가지고 있는 비어있는 객체이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVQoz5VS24qDUAz0/3+kfe+z4KLFCxYEi0URBPFFj1WrrXedJYHKsmy7u4EwnJwwkwyRxnHEuq6geOJv8b3v61u6XC4YhmErzPOMZVnQ9z3atgUJ0pt6KOu65roQAmEYIssydF2HsigZJcdx8Hg8WGWaJnieB9u2oSgKFOUDx+MRuq4zJkkC6nddF6ZpYr/b43Q64Xw+M3lRFJCyTPBkt+qGsixRVRV/ENI0hFS/3++IogiqquJwOEDTNBaP4xi0JYkxIRVosr8ErWQYBmRZhmVZ8H0feZ6z6EYYBAGaptnMfZUU5OX1eoUQOXuYpikj+UjENJhERlPjO8L/XID06hR+Oot3GzzzE4D5ZCURMAveAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image1\"\n        title=\"image1\"\n        src=\"/static/835023913ed13c3757f317293e052c76/37523/image1.png\"\n        srcset=\"/static/835023913ed13c3757f317293e052c76/e9ff0/image1.png 180w,\n/static/835023913ed13c3757f317293e052c76/f21e7/image1.png 360w,\n/static/835023913ed13c3757f317293e052c76/37523/image1.png 720w,\n/static/835023913ed13c3757f317293e052c76/612f7/image1.png 773w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>프록시 객체는 실제 Entity를 상속해서 만들어지며, Hibernate가 내부적으로 만든다.</p>\n<p>실제 클래스와 겉 모양이 같기 때문에 사용하는 입장에서는 진짜 객체인지 프록시 객체인지 구분하지 않고 사용할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 338px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 206.1111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAApCAYAAAA1bQl+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAElUlEQVRIx7WXZ09iURCG+a3+Dz/qFxMTTewKxGQt2HUFLNi7AtLE3ksEe6/M5hlzrndR3HWTnWRyuefMmTPtvjM4RESurq4kHA5LNBqTaDSqHIlEJR6PK6+ursrKyoo+l5eXdc3I2fn5+VkcKIzFYpJILMn9/b1cXFzKxcWFbg4MDIjH45FQKCT9/f3S1NQkyaWkHB0dyc3NjVxevsk+Pj7K2NiYpNPpd4UHBweSTePj49LQ0CDV1dVSV1cnxcXFUlJSInt7ex9kg8GgpFKpN4WLi4vS09MjkUhEpqamZGFhQa2amJhQy2ZnZ9WCyclJaW9v130UwPPz8+puc3Pzu4XEJJFI6AEOPj09qRu4nclk9Pn6+iovLy9qDfuGHx4edG1mZkaOj4/fFW6sb8jS0pJsbm5+cAeln/22v2O15TIx3Nra0iCfnJzI7u6uxpTgn5+ff6rIEJZDuG4pxDKUzs3NSWtrq8YTgc7OTi0VCHc5nM0mDJz9LSler9dKxOjoqMZyeHhYlZIo6tQkIhgMqSzMO8ZQXlZSSAhx5GBbW5v4/X7xen3i8/k0q8lkUq0hASQINkkheSYploUo5Eug7rgtlUrLzs6ObGxsqLLb21srZrj4WZIW5m1JwTqSwsLh4aEqwl2UnZ6eytramiaJPdxE9ssso9AUt9PplKGhIWXcJ4a4HgqGpLGxUdfxCEvtLk9PT7/XIe5VVFRIUVGRVFZWSm1trbicLn1WVVVJTU2N5Ofn6+dXVlYm1dU14na79XKXyyV1TqfU19draBzGZG4yNxJ8GLBgH4QJBIbUbd5Zt/Pd3Z0mClKFuYoWAlU6Ojpkbm5eS+srQo/D/MjFEMngO8cak+VcbLmcrcSeQVwicXa5D992xmZhLvON8PX1tUJbrovt5PhTTHIpzEX/V6FdONtlUPmvFdqVAAL257cV2pXlon+2kIN0tLOzM0Vt0y++baGBcYCgsLBQv+G8vDzp7e3VdVrDtyw0CkHpgoICRWyQpbu7W9dp5ibLuVqBibkju+rBPzuYQrjOxPA35DB9Fggjbny3/AZEQRdAE4BlLDF78Pb2trKRZc/69FaWV7SfIECXQwGCuA7e0QFpUnRHWgW8vr6uvLq6JtvbOzph0HJVIQEns9kEINBWAVZiWl5erihuYp4tayE28M8N9BAzmgHzpn329fVJS0uLdHV1KYKzRjN7G/siCsBcZLVRFmGySczY4EmCmCRYZ4Y0zBoy6fSJylGn9BqrSXETtwDj9AU7tIPYHKAWjULeDbNOUmnBlkJcoLHPzszq5ECXowZ//uwVt8utLZVLCU04vKjy/IZDobCGx+NpkVTq2Mw2Sc3syMiIBp8CHxsbVzeI7f7+/h/rj0t+G+cohbepIaVuUFtMX8TK9F6IQ8TUzI24CzGUvo8i8YQWNXXFjGJCQFyI7cTEpD6ZsDj42QxJUi0LY7G4AkNpaanO0Gako5nT5Ftb28Tb69VZ+8ePBi0j4mb+LXAZQ5VVNhS13+dXJSRgcHBQPzWaeyAQkMHBgL6zR0xR6Pf36ZTGk35tRmnHV1D0fcrILzMgyWew/71eAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image2\"\n        title=\"image2\"\n        src=\"/static/a7e3860d5829674a4505da8f3c996663/2b41d/image2.png\"\n        srcset=\"/static/a7e3860d5829674a4505da8f3c996663/e9ff0/image2.png 180w,\n/static/a7e3860d5829674a4505da8f3c996663/2b41d/image2.png 338w\"\n        sizes=\"(max-width: 338px) 100vw, 338px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>프록시 객체는 실제 객체의 참조(target)를 보관하고, 프록시 객체를 호출하면 프록시 객체는 실제 객체의 메소드를 호출한다.</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">\b<span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">getReference</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"id1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmembmer<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p>이렇게 호출을 한다고 생각해보자.</p>\n<p>getName 호출하게 되면 MemberProxy객체에 target이 없기 때문에 JPA가 영속성 컨텍스트에 진짜 Member객체 가져오라고 초기화 요청을 하게 되고, 영속성 컨텍스트는 DB를 조회해서 실제 Member 엔티티 객체를 생성해준다.</p>\n<p>그리고 Proxy와 진짜 객체를 연결해주어 getName()을 했을 때 target.getName()을 통해서 진짜 엔티티 객체로부터 값을 가져오게 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQY031Ry4qDUAz1/z9kunDXZUGwGx0tdLS2UopvLdVW+1DEtj7OkAwOMosJhJtLTpKTE6Hve0xt/D+fT3ieh+PxiCzLcLlccD6fUdc1hmFA27Z4v994vV6/cdd1EMqyRBAEME0TaZrier3idrsxiBqSR1EEx3EY1zQNYyg+HA4QRRGapnGt7/sQFEXBcrnE7GOG+XyOMAzhui43HI0YTV8aYFkWHo8SRVEwgaqqkCQJBFmWIUkS9vs9NpsN8jxnVgQkJn+dirfbLVT1E7qusxQkD+XiOP5hqKoqg4Ig5OTpdMJ/RkMXiwVvRlLRVvf7nZkLu92OtaDXtm1el9iNK059PBixXK1WMAwD6/UXDMNk/eiA30ASvJtRl37AAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image3\"\n        title=\"image3\"\n        src=\"/static/d89fd057014a0a8083cf8726068048f8/37523/image3.png\"\n        srcset=\"/static/d89fd057014a0a8083cf8726068048f8/e9ff0/image3.png 180w,\n/static/d89fd057014a0a8083cf8726068048f8/f21e7/image3.png 360w,\n/static/d89fd057014a0a8083cf8726068048f8/37523/image3.png 720w,\n/static/d89fd057014a0a8083cf8726068048f8/612f7/image3.png 773w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"2-proxy-객체의-특징\" style=\"position:relative;\"><a href=\"#2-proxy-%EA%B0%9D%EC%B2%B4%EC%9D%98-%ED%8A%B9%EC%A7%95\" aria-label=\"2 proxy 객체의 특징 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Proxy 객체의 특징</h2>\n<p>(1) 프록시 객체는 처음 사용할 때 한 번만 초기화 된다.</p>\n<p>(2) 프록시 객체가 실제 entity로 바뀌는게 아니라 프록시 객체를 통해 실제 entity로 접근하게 되는 것이다.</p>\n<p>(3) 프록시 객체는 원본 엔티티를 상속받은 객체기 때문에 타입 비교 시에 ’==’ 대신 ‘instance of’를 사용한다.</p>\n<ul>\n<li>JPA에서 타입 비교시 instance of 사용을 권장하는 이유임</li>\n</ul>\n<p>(4) 영속성 컨텍스트에 찾는 엔티티가 이미 존재한다면, em.getReference 호출 시에도 실제 엔티티를 반환한다.</p>\n<ul>\n<li>\n<p>반대로, 이미 getReference로 반환했다면 동일한 id로 find를 해도 proxy객체를 반환한다.</p>\n</li>\n<li>\n<p>JPA에서는 동일한 데이터에 대해서 ’==’ 비교를 true로 해주는 것이 보장되어야 하기 때문이다.</p>\n</li>\n</ul>\n<p>(5) 영속성 컨텍스트의 도움을 받을 수 없는 준영속 상태일 때 프록시를 초기화 시에 에러가 발생한다.(종종 발생!)</p>\n<ul>\n<li>org.hibernate.LazyInitializationException</li>\n</ul>\n<p>​</p>\n<h2 id=\"3-프록시-확인\" style=\"position:relative;\"><a href=\"#3-%ED%94%84%EB%A1%9D%EC%8B%9C-%ED%99%95%EC%9D%B8\" aria-label=\"3 프록시 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 프록시 확인</h2>\n<p>(1) 프록시 인스턴스 초기화 여부 확인</p>\n<ul>\n<li>PersistenceUnitUtil.isLoaded(entity)</li>\n</ul>\n<p>(2) 프록시 클래스 확인 방법</p>\n<ul>\n<li>entity.getClass()해서 찍어봐야 함</li>\n</ul>\n<p>(3) 프록시 강제초기화</p>\n<ul>\n<li>\n<p>Hibernate.initialize(entity) // JPA 표준에는 없음</p>\n</li>\n<li>\n<p>entity.getUserName() 이런식으로 실제 entity의 멤버값을 호출하면 강제 초기화 됨.</p>\n</li>\n</ul>\n<hr>\n<p>그리고 이렇게 JPA의 Proxy에 대해  설명한 것은 즉시로딩과 지연로딩에 대해서 이해하기 위함이다.</p>\n<h2 id=\"4-지연-로딩lazy-loading\" style=\"position:relative;\"><a href=\"#4-%EC%A7%80%EC%97%B0-%EB%A1%9C%EB%94%A9lazy-loading\" aria-label=\"4 지연 로딩lazy loading permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 지연 로딩(Lazy loading)</h2>\n<p>지연로딩을 사용해서 Team 엔티티에 대해서 ManyToOne 매핑을 한다고 하면, 아래와 같이 FetchType을 Lazy로 설정해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Member</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> team_id<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Team</span> team<span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그러면 JPA에서 member를 find했을 때 member 테이블만 select 해 온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Member</span> m <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> member<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// member 테이블만 select</span></code></pre></div>\n<p>아래를 실행하면 Team 프록시 객체를 반환함을 알 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"m=\"</span><span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">.</span><span class=\"token function\">getTeam</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>아래와 같이 Team 엔티티의 실제 값을 조회오고자 할 때 그 시점에 JPA에서 Team 테이블에 대한 select 쿼리를 날려서 데이터를 조회해온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">m<span class=\"token punctuation\">.</span><span class=\"token function\">getTeam</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 이 시점에 select 쿼리 날림 </span></code></pre></div>\n<p>정리해보면 아래와 같다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABa0lEQVQ4y42TW4+CMBCF+/9/kMojL75qIg8uoHEBo1y9goDi2ZxJuul2zbqTDCV05sw306JutxvKsoRtj8cD5/MZp9NJVsY9n88fMff7XXKjKMJut8PlcoHiY71eS3Ce59hsPpFlGVarFRzHgTNxMBqNsFwukaYpttst4jgWAd/3EQQBPM9DGIayr7quQ1VV6PteaOh1XWM+n2M8HstKcVIURSEUOoYg0+lUCjCfIIrtsKptbGWxWCAIQiRJImJ2y2VZwXVdzGYzod3vUyjOQc/HdNr1epUxJHGC4/Eo3/T+MAxCyn2SEUAIzYqmmE6isyi74GhYvGkaIaZI27ZSmN+5KpvKfqcxmImHw0GI6JxZ09RS0DRlz+6VMIn0geV5Ia1x9izA62XG/xJ8JU4KJrNNTUfnDbG7+VPQDGTLpPI//O8DsmPeCtrV2TIvL68RCV/FvBU0E0jGtjlDW/BfhLYo/w7OkKL6dG3BLxE/7cvtiDCAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image4\"\n        title=\"image4\"\n        src=\"/static/1845d59f1268873ac620a122fd487dab/37523/image4.png\"\n        srcset=\"/static/1845d59f1268873ac620a122fd487dab/e9ff0/image4.png 180w,\n/static/1845d59f1268873ac620a122fd487dab/f21e7/image4.png 360w,\n/static/1845d59f1268873ac620a122fd487dab/37523/image4.png 720w,\n/static/1845d59f1268873ac620a122fd487dab/612f7/image4.png 773w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>만약에 Member와 Team을 항상 같이 조회시킨다면 지연로딩이 아닌 즉시 로딩을 사용하는 것이 낫다.</p>\n<h2 id=\"5-즉시-로딩-eager-loading\" style=\"position:relative;\"><a href=\"#5-%EC%A6%89%EC%8B%9C-%EB%A1%9C%EB%94%A9-eager-loading\" aria-label=\"5 즉시 로딩 eager loading permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 즉시 로딩 (Eager loading)</h2>\n<p>즉시 로딩을 하기 위해서는 ManyToOne의 fetchtype을 EAGER로 설정만 해주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Member</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>EAGER<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> team_id<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Team</span> team<span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 하면 em.find(member) 하면 Member와 Team에 대한 데이터를 조인해서 한 번에 다 가져오게 된다. 그래서 proxy객체를 사용하지 않게 된다.</p>\n<h2 id=\"6-실무에서-지연로딩만-쓰는-이유\" style=\"position:relative;\"><a href=\"#6-%EC%8B%A4%EB%AC%B4%EC%97%90%EC%84%9C-%EC%A7%80%EC%97%B0%EB%A1%9C%EB%94%A9%EB%A7%8C-%EC%93%B0%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"6 실무에서 지연로딩만 쓰는 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 실무에서 지연로딩만 쓰는 이유</h2>\n<h3 id=\"1-즉시-로딩을-사용하면-전혀-예상할-수-없는-sql이-발생한다\" style=\"position:relative;\"><a href=\"#1-%EC%A6%89%EC%8B%9C-%EB%A1%9C%EB%94%A9%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A9%B4-%EC%A0%84%ED%98%80-%EC%98%88%EC%83%81%ED%95%A0-%EC%88%98-%EC%97%86%EB%8A%94-sql%EC%9D%B4-%EB%B0%9C%EC%83%9D%ED%95%9C%EB%8B%A4\" aria-label=\"1 즉시 로딩을 사용하면 전혀 예상할 수 없는 sql이 발생한다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) 즉시 로딩을 사용하면 전혀 예상할 수 없는 SQL이 발생한다.</h3>\n<p>1,2개 조인한다고 해서 문제가 없지만, 모두 EAGER로 되어 있고 5개 테이블이 연결되어 있다고 생각하면 find시 조인이 5개~10개 테이블이 한꺼번에 불러오는 문제가 발생한다.</p>\n<h3 id=\"2-즉시-로딩은-jpql에서-n1-문제를-일으킨다\" style=\"position:relative;\"><a href=\"#2-%EC%A6%89%EC%8B%9C-%EB%A1%9C%EB%94%A9%EC%9D%80-jpql%EC%97%90%EC%84%9C-n1-%EB%AC%B8%EC%A0%9C%EB%A5%BC-%EC%9D%BC%EC%9C%BC%ED%82%A8%EB%8B%A4\" aria-label=\"2 즉시 로딩은 jpql에서 n1 문제를 일으킨다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 즉시 로딩은 JPQL에서 N+1 문제를 일으킨다.</h3>\n<p>N+1 문제는 쿼리를 1개 날렸는데 그에 따른 따른 쿼리를 처음 날린 쿼리의 데이터 개수인 N개 만큼 더 실행시켜야 하는 문제이다. 예컨대 EAGER로 Team을 설정 후, JPQL을 통해 member를 조회해온다고 해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Members</span><span class=\"token punctuation\">></span></span> members <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>그러면 select * from member 쿼리가 처음에 1번 호출되게 될 것이고,</p>\n<p>불러와놓고 보니 team이 EAGER로 설정되어 있기 때문에, member 각각에 대해서 team 데이터를 다 가지고 있어야 하기 때문에 아래와 같이 member각각에 설정된 team 데이터를 불러오기 위해 SQL문이 N번 호출되게 된다는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">from</span> team <span class=\"token keyword\">where</span> team_id <span class=\"token operator\">=</span> ?</code></pre></div>\n<p>그래서 Member와 Team을 항상 같이 조회해온다고 하더라도 그냥 fetchType은 LAZY로 해두고, JPQL에서 fetch join 같은 걸 아래처럼 사용하는 것이 안전하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Members</span><span class=\"token punctuation\">></span></span> members <span class=\"token operator\">=</span> em<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select m from Member m join fetch m.team\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">getResultList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p>따라서 ManyToOne, OneToOne 은 기본이 EAGER이므로 항상 LAZY로 설정해주어야 한다.</p>\n<hr>\n<h3 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h3>\n<ul>\n<li><a href=\"https://www.inflearn.com/course/ORM-JPA-Basic\">https://www.inflearn.com/course/ORM-JPA-Basic</a></li>\n</ul>","frontmatter":{"date":"March 24, 2022","title":"[JPA] 8. JPA프록시와 지연로딩(Lazy Loading)과 즉시로딩(Eager Loading)","categories":"Spring","author":"jjunyong","emoji":"🧢"},"fields":{"slug":"/jpa8/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://steadyandslow.com","comments":{"utterances":{"repo":"jjunyong/jjunyong.github.io"}}}}},"pageContext":{"slug":"/aws_jasypt/","nextSlug":"/jpa8/","prevSlug":""}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}