{"componentChunkName":"component---src-templates-blog-template-js","path":"/troubleshoot-istio-tls/","result":{"data":{"cur":{"id":"b54bb0f6-1a8e-530a-8184-053da1370d38","html":"<p>Let’s ecrypt를 활용해서 3개월 마다 istio의 tls인증서를 \b자동 갱신하도록 설정하는 방법도 있으나,\n설정 과정이 다소 복잡하고 트러블 슈팅이 어려운 문제가 있었다.\n그래서 결국 가비아를 통해 Sectico 인증서를 3년에 6만원 정도로 구입하여 적용하는 방법을 택했고, 이 방법이 대부분의 enterprise 환경에서도 사용되는 방법일 것이다.</p>\n<h2 id=\"1-tls-인증서-준비-및-tls-secret-생성\" style=\"position:relative;\"><a href=\"#1-tls-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EC%A4%80%EB%B9%84-%EB%B0%8F-tls-secret-%EC%83%9D%EC%84%B1\" aria-label=\"1 tls 인증서 준비 및 tls secret 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. TLS 인증서 준비 및 tls Secret 생성</h2>\n<ul>\n<li>\n<p>가비아에서 Sectio 인증서를 나의 도메인으로 발급 받았고, 아래와 같이 4개 인증서를 제공 받았다.</p>\n</li>\n<li>\n<p>abc_company_root_cert.crt : 루트 인증서 파일</p>\n</li>\n<li>\n<p>abc_company_chain_cert.crt : 체인 인증서 파일</p>\n</li>\n<li>\n<p>abc_company.key: 도메인 인증서 파일</p>\n</li>\n<li>\n<p>abc_company_cert.crt : 개인 키 파일</p>\n</li>\n<li>\n<p>해당 파일 중 개인 키 파일 과 도메인 인증서 파일 2개를 사용하여 istio-system namespace에 tls secret을 생성한다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl create secret tls abc-company-tls <span class=\"token parameter variable\">--key</span><span class=\"token operator\">=</span>abc_company.key <span class=\"token parameter variable\">--cert</span><span class=\"token operator\">=</span>abc_company_cert.crt <span class=\"token parameter variable\">-n</span> istio-system</code></pre></div>\n<p>…\n라고 했지만 위와 같이 secret 생성했을 때 RN Android 환경에서 SSL 접근 시 network failed 이슈가 있었다.</p>\n<h3 id=\"인증서-오류-발생\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D%EC%84%9C-%EC%98%A4%EB%A5%98-%EB%B0%9C%EC%83%9D\" aria-label=\"인증서 오류 발생 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증서 오류 발생</h3>\n<ul>\n<li>\n<p>SSL Checker와 같은 웹 검증 툴을 사용해서 확인해보니 인증서 자체는 적용되었지만 경고 메시지가 떴다.\n<code class=\"language-text\">The certificate is not trusted in all web browsers. You may need to install an Intermediate/chain certificate to link it to a trusted root certificate.</code></p>\n</li>\n<li>\n<p>원래는 하기와 같이 도메인 인증서와 체인 인증서를 합쳐서 combined 인증서를 만든 뒤에 해당 파일을 활용해서 k8s tls secret을 생성하여야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> abc_company_cert.crt abc_company_chain_cert.crt <span class=\"token operator\">></span> abc_company_combined.crt</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl create secret tls abc-company-tls <span class=\"token parameter variable\">--key</span><span class=\"token operator\">=</span>abc_company.key <span class=\"token parameter variable\">--cert</span><span class=\"token operator\">=</span>abc_company_combined.crt <span class=\"token parameter variable\">-n</span> istio-system</code></pre></div>\n</li>\n</ul>\n<p>그런데 이렇게 했을 때, 아래 에러가 발생하여서 domain 인증서로만 작업을 하고 넘어갔었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">error: tls: private key does not match public key</code></pre></div>\n<br>\n<p>아무리 찾아봐도 방법 자체에는 문제가 없는 것 같아서 합쳐진 combined.crt 인증서를 확인해보니 아래와 같이\nEND CERTIFICATE 부분과 BEGIN CERTIFICATE 부분이 ’----‘로 연결되어 있었다.</p>\n<h4 id=\"수정-전\" style=\"position:relative;\"><a href=\"#%EC%88%98%EC%A0%95-%EC%A0%84\" aria-label=\"수정 전 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>수정 전</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">## BEFORE</span>\n-----BEGIN CERTIFICATE-----\nMOdUgph2fOKBZVrROOUwDQYJKoZIhGlnb1JT\nQURvbWFpblZhbGlkYXNLYanoVX8ET4pp\ndeJV9b9rWYUYUJja0i3+1LZrsAurhUZZtmlHy9ATgtStyITX5cDekv/21tK+0JcV\nvO4F6r2gFH/+oT1\n<span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span><span class=\"token punctuation\">..</span>\n-----END CERTIFICATE----------BEGIN CERTIFICATE-----\nfVtRJrR2uhHbdBYLvFMNpzANBgkqhkiG9w0BAQwFADCB\niDELMAVyIENBMIIBIjANBgkqhkiG9w0BAQEFAAOC\nAQ8AMIIBCgKCAQEA1nMz1tc8INAA0hdFuNY+B6I/x0H</code></pre></div>\n<h4 id=\"수정-후\" style=\"position:relative;\"><a href=\"#%EC%88%98%EC%A0%95-%ED%9B%84\" aria-label=\"수정 후 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>수정 후</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">\n<span class=\"token comment\">## AFTER</span>\n-----BEGIN CERTIFICATE-----\nMOdUgph2fOKBZVrROOUwDQYJKoZIhGlnb1JT\nQURvbWFpblZhbGlkYXNLYanoVX8ET4pp\ndeJV9b9rWYUYUJja0i3+1LZrsAurhUZZtmlHy9ATgtStyITX5cDekv/21tK+0JcV\nvO4F6r2gFH/+oT1\n<span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span><span class=\"token punctuation\">..</span>\n-----END CERTIFICATE-----\n----BEGIN CERTIFICATE-----\nfVtRJrR2uhHbdBYLvFMNpzANBgkqhkiG9w0BAQwFADCB\niDELMAVyIENBMIIBIjANBgkqhkiG9w0BAQEFAAOC\nAQ8AMIIBCgKCAQEA1nMz1tc8INAA0hdFuNY+B6I/x0H</code></pre></div>\n<p>위와 같이 개행을 제대로 해주고 나니 k8s tls secret 생성 시 정상적으로 tls secret이 생성에 성공했고,\nSSL checker에서도 경고 메세지가 사라졌으며, 모든 환경에서 tls 접속이 잘 되게 되었다.</p>\n<h2 id=\"2-istio-gateway-virtualservice-설정\" style=\"position:relative;\"><a href=\"#2-istio-gateway-virtualservice-%EC%84%A4%EC%A0%95\" aria-label=\"2 istio gateway virtualservice 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Istio Gateway, VirtualService 설정</h2>\n<h3 id=\"gateway-설정\" style=\"position:relative;\"><a href=\"#gateway-%EC%84%A4%EC%A0%95\" aria-label=\"gateway 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gateway 설정</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.istio.io/v1alpha3\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Gateway\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>gateway\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> istio<span class=\"token punctuation\">-</span>system\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">istio</span><span class=\"token punctuation\">:</span> ingressgateway\n  <span class=\"token key atrule\">servers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">443</span>\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> https\n        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> HTTPS\n      <span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">mode</span><span class=\"token punctuation\">:</span> SIMPLE\n        <span class=\"token key atrule\">credentialName</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>tls<span class=\"token punctuation\">-</span>secret\n      <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token string\">'abc.company'</span></code></pre></div>\n<h3 id=\"virtualservice-설정\" style=\"position:relative;\"><a href=\"#virtualservice-%EC%84%A4%EC%A0%95\" aria-label=\"virtualservice 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VirtualService 설정</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.istio.io/v1alpha3\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> VirtualService\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>virtualservice\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> istio<span class=\"token punctuation\">-</span>system\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">'abc.company'</span>\n  <span class=\"token key atrule\">gateways</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> my<span class=\"token punctuation\">-</span>gateway.istio<span class=\"token punctuation\">-</span>system.svc.cluster.local\n  <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">match</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uri</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">prefix</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span>\n      <span class=\"token key atrule\">route</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">destination</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>service\n            <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>\n<h2 id=\"3-istio에서-tls-작업-시-유의-사항\" style=\"position:relative;\"><a href=\"#3-istio%EC%97%90%EC%84%9C-tls-%EC%9E%91%EC%97%85-%EC%8B%9C-%EC%9C%A0%EC%9D%98-%EC%82%AC%ED%95%AD\" aria-label=\"3 istio에서 tls 작업 시 유의 사항 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Istio에서 TLS 작업 시 유의 사항</h2>\n<ul>\n<li>나는 dev라는 별도의 namespace에 gateway, vs, secret을 두고 https 연동이 안되어 많은 시간을 버렸다.</li>\n<li><strong>반드시, ingress-gateway가 존재하는 istio-system namespace에 gateway와 secret을 설정하여야 하고</strong>, VirtualService같은 경우는 FQDN으로 gateway를 위의 yaml과 같이 지정하면 어떤 namespace에 있어도 상관없지만, 이 또한 같은 namespace에 두고 FQDN을 안 적는 것이 속편할 수 있다.</li>\n<li>tls secret 생성 시 반드시 도메인 인증서와 체인 인증서를 결합한 ( 결합 시 개행에 유의 ) cominbed 인증서로 생성할 것!</li>\n</ul>","excerpt":"Let’s ecrypt를 활용해서 3개월 마다 istio의 tls인증서를 \b자동 갱신하도록 설정하는 방법도 있으나,\n설정 과정이 다소 복잡하고 트러블 슈팅이 어려운 문제가 있었다.\n그래서 결국 가비아를 통해 Sectico 인증서를 3년에 6만원 정도로 구입하여 적용하는 방법을 택했고, 이 방법이 대부분의 enterprise 환경에서도 사용되는 방법일 것이다. 1. TLS 인증서 준비 및 tls Secret 생성 가비아에서 Sectio 인증서를 나의 도메인으로 발급 받았고, 아래와 같이 4개 인증서를 제공 받았다. abc_company_root_cert.crt : 루트 인증서 파일 abc_company_chain_cert.crt : 체인 인증서 파일 abc_company.key: 도메인 인증서 파일 abc_company_cert.crt : 개인 키 파일 해당 파일 중 개인 키 파일 과 도메인 인증서 파일 2개를 사용하여 istio-system namespace에 tls secret을…","frontmatter":{"date":"May 08, 2024","title":"Istio 클러스터에 가비아 Sectico SSL/TLS 인증서 설치하기","categories":"Troubleshoot","author":"jjunyong","emoji":"🧢"},"fields":{"slug":"/troubleshoot-istio-tls/"}},"next":{"id":"baf42faa-d89b-5018-a97f-67e78c7d3514","html":"<h2 id=\"제어문\" style=\"position:relative;\"><a href=\"#%EC%A0%9C%EC%96%B4%EB%AC%B8\" aria-label=\"제어문 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>제어문</h2>\n<h3 id=\"if문-expression-과-statement\" style=\"position:relative;\"><a href=\"#if%EB%AC%B8-expression-%EA%B3%BC-statement\" aria-label=\"if문 expression 과 statement permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>If문, Expression 과 Statement</h3>\n<ul>\n<li>기본적인 if-else의 문법은 동일하다.</li>\n<li>Java에서 if-else는 Statement이지만 Kotlin에서는 expression이다. 즉 삼항연산자 처럼 값을 리턴할 수 있다.\n<ul>\n<li>따라서 삼항연산자가 없음</li>\n</ul>\n</li>\n<li>in 연산자를 활용 가능\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">example</span><span class=\"token punctuation\">(</span>score<span class=\"token operator\">:</span> Int<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> score <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token operator\">..</span><span class=\"token number\">100</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"switch-와-when\" style=\"position:relative;\"><a href=\"#switch-%EC%99%80-when\" aria-label=\"switch 와 when permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>switch 와 when</h3>\n<ul>\n<li>switch case 문 대신에 when으로 kotlin에서는 대체되었으며 조건부를 다양하게 사용할 수 있다.\n<img src=\"./image1.png\" alt=\"image1\">\n<ul>\n<li>is 문, ..문 등 사용</li>\n<li><code class=\"language-text\">-1,0,1 -> println(\"-1 또는 0또는 1입니다\")</code>와 같이도 쓸 수 있음</li>\n<li>when뒤에 소괄호없이 바로 조건부와 결과로만 when절을 구성할 수도 있다.\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">when{\n  number == 0 -> println(\"test\")\n  else -> println(\"else\")\n  )\n}</code></pre></div>\n</li>\n</ul>\n</li>\n<li>Enum 클래스, Sealed 클래스와 함께 사용할 경우 더욱 진가가 발휘된다.</li>\n</ul>\n<h2 id=\"반복문\" style=\"position:relative;\"><a href=\"#%EB%B0%98%EB%B3%B5%EB%AC%B8\" aria-label=\"반복문 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>반복문</h2>\n<h3 id=\"for-each-문--향상된-for문-\" style=\"position:relative;\"><a href=\"#for-each-%EB%AC%B8--%ED%96%A5%EC%83%81%EB%90%9C-for%EB%AC%B8-\" aria-label=\"for each 문  향상된 for문  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>for-each 문 ( 향상된 for문 )</h3>\n<ul>\n<li>’:’ 대신 ‘in’을 쓰는 정도만 다르다.</li>\n</ul>\n<h3 id=\"전통적인-for문\" style=\"position:relative;\"><a href=\"#%EC%A0%84%ED%86%B5%EC%A0%81%EC%9D%B8-for%EB%AC%B8\" aria-label=\"전통적인 for문 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전통적인 for문</h3>\n<ul>\n<li>in을 사용한여 범위를 표현한다.</li>\n<li>progression, range를 활용한 등차수열을 쓴다.\n<ul>\n<li>downTo, step 등의 표현</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"예외\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%99%B8\" aria-label=\"예외 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예외</h2>\n<h3 id=\"try-catch-finally-구문\" style=\"position:relative;\"><a href=\"#try-catch-finally-%EA%B5%AC%EB%AC%B8\" aria-label=\"try catch finally 구문 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>try catch finally 구문</h3>\n<ul>\n<li>자바와 기본적으로 동일</li>\n</ul>\n<h3 id=\"checked-unchecked-exception울-구분하지-않는다\" style=\"position:relative;\"><a href=\"#checked-unchecked-exception%EC%9A%B8-%EA%B5%AC%EB%B6%84%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94%EB%8B%A4\" aria-label=\"checked unchecked exception울 구분하지 않는다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Checked, Unchecked exception울 구분하지 않는다.</h3>\n<ul>\n<li>즉, 모두가 unchecked 이므로 throw를 쓸 일이 없다.</li>\n</ul>\n<h3 id=\"try-with-resources\" style=\"position:relative;\"><a href=\"#try-with-resources\" aria-label=\"try with resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>try with resources</h3>\n<ul>\n<li>try with resources 사라짐</li>\n<li>use문을 대신 사용한다.</li>\n</ul>\n<h2 id=\"함수\" style=\"position:relative;\"><a href=\"#%ED%95%A8%EC%88%98\" aria-label=\"함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>함수</h2>\n<h3 id=\"함수-선언-문법\" style=\"position:relative;\"><a href=\"#%ED%95%A8%EC%88%98-%EC%84%A0%EC%96%B8-%EB%AC%B8%EB%B2%95\" aria-label=\"함수 선언 문법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>함수 선언 문법</h3>\n<ul>\n<li>public은 생략 가능 디폴트가 public이다.</li>\n<li>Unit도 생략 가능</li>\n<li>if else가 expression인 것과 함수가 하나의 결과 값이라면 아래와 같이 괄호 대신 =를 함수에 쓸 수 있다.\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> Int<span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> Int<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Int <span class=\"token operator\">=</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> a <span class=\"token operator\">></span> b <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    a\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    b\n  <span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>한 줄로 변경가능, 자동 type 추론과 block이 없음을 활용하면 아래와 같이 더 간결해질 수 있다.\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> Int<span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> Int<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> a <span class=\"token operator\">></span> b <span class=\"token punctuation\">)</span> a <span class=\"token keyword\">else</span> b</code></pre></div>\n</li>\n</ul>\n<h3 id=\"디폴트-파라미터\" style=\"position:relative;\"><a href=\"#%EB%94%94%ED%8F%B4%ED%8A%B8-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0\" aria-label=\"디폴트 파라미터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>디폴트 파라미터</h3>\n<h3 id=\"named-argument\" style=\"position:relative;\"><a href=\"#named-argument\" aria-label=\"named argument permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>named argument</h3>\n<ul>\n<li>빌더를 직접 만들지 않고도 빌더의 장점을 지니게 된다.</li>\n</ul>\n<h3 id=\"같은-타입의-여러-파라미터-받기--가변인자-\" style=\"position:relative;\"><a href=\"#%EA%B0%99%EC%9D%80-%ED%83%80%EC%9E%85%EC%9D%98-%EC%97%AC%EB%9F%AC-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0-%EB%B0%9B%EA%B8%B0--%EA%B0%80%EB%B3%80%EC%9D%B8%EC%9E%90-\" aria-label=\"같은 타입의 여러 파라미터 받기  가변인자  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>같은 타입의 여러 파라미터 받기 ( 가변인자 )</h3>\n<ul>\n<li>\n<p>vararg 키워드 사용해야 하고 가변인자 함수를 배열과 함께 호출할 때는 ’*’ ( 스프레드 연산자 )를 붙여줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token function\">printAll</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>arrays<span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h3>\n<ul>\n<li><a href=\"https://www.inflearn.com/course/lecture?courseSlug=java-to-kotlin\">https://www.inflearn.com/course/lecture?courseSlug=java-to-kotlin</a></li>\n<li><a href=\"https://github.com/lannstark/java-to-kotlin-starter-guide\">https://github.com/lannstark/java-to-kotlin-starter-guide</a></li>\n</ul>","frontmatter":{"date":"April 29, 2024","title":"[Kotlin] 코드 제어하는 방법","categories":"Java/Kotlin","author":"jjunyong","emoji":"🧢"},"fields":{"slug":"/kotlin5/"}},"prev":{"id":"b0cc66a6-0bbd-58e7-83b6-6780b87f1a11","html":"<p>홈 서버로 API 서버를 운영 중에 이벤트 뷰어 상에서 Windows 자동 업데이트 및 Kernel power 이벤트로 자꾸 서버가 재부팅되며 운영 상에 문제가 발생하였다.\n이를 해결하기 위한 방법에 대한 글이다.</p>\n<h2 id=\"윈도우-os-자동-재부팅-방지\" style=\"position:relative;\"><a href=\"#%EC%9C%88%EB%8F%84%EC%9A%B0-os-%EC%9E%90%EB%8F%99-%EC%9E%AC%EB%B6%80%ED%8C%85-%EB%B0%A9%EC%A7%80\" aria-label=\"윈도우 os 자동 재부팅 방지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>윈도우 OS 자동 재부팅 방지</h2>\n<ul>\n<li>관련 이벤트 : 1074</li>\n<li>기존에는 아래와 블로그 글과 같은 해결 방법을 통해 자동 업데이트 차단이 가능했으나 이제는 불가능하다.\n<ul>\n<li><a href=\"https://igotit.tistory.com/entry/%EC%9C%88%EB%8F%84%EC%9A%B0-10-%EC%9E%90%EB%8F%99%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%9E%90%EB%8F%99%EC%9E%AC%EB%B6%80%ED%8C%85-%EB%B0%A9%EC%A7%80-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">https://igotit.tistory.com/entry/%EC%9C%88%EB%8F%84%EC%9A%B0-10-%EC%9E%90%EB%8F%99%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%9E%90%EB%8F%99%EC%9E%AC%EB%B6%80%ED%8C%85-%EB%B0%A9%EC%A7%80-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"window-10-프로-홈서버-os-자동-업데이트-방지-방법-업뎃\" style=\"position:relative;\"><a href=\"#window-10-%ED%94%84%EB%A1%9C-%ED%99%88%EC%84%9C%EB%B2%84-os-%EC%9E%90%EB%8F%99-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EB%B0%A9%EC%A7%80-%EB%B0%A9%EB%B2%95-%EC%97%85%EB%8E%83\" aria-label=\"window 10 프로 홈서버 os 자동 업데이트 방지 방법 업뎃 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Window 10 프로 홈서버 OS 자동 업데이트 방지 방법 업뎃</h3>\n<h4 id=\"1-gpeditmsc-로-그룹-정책-편집기-열기\" style=\"position:relative;\"><a href=\"#1-gpeditmsc-%EB%A1%9C-%EA%B7%B8%EB%A3%B9-%EC%A0%95%EC%B1%85-%ED%8E%B8%EC%A7%91%EA%B8%B0-%EC%97%B4%EA%B8%B0\" aria-label=\"1 gpeditmsc 로 그룹 정책 편집기 열기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. gpedit.msc 로 그룹 정책 편집기 열기</h4>\n<ul>\n<li>\n<p>컴퓨터 구성 - 관리 템플릿 - Windows 구성 요소 - Windows 업데이트에서 ‘자동 업데이트 구성’을 선택한 후 ‘사용 안함’ 을 ‘사용’으로 바꿔주고, 정책을 3번 : 자동으로 다운로드 하고 설치할 때 알림’ 으로 설정해 준다. 이렇게 하면 자동으로 업데이트를 다운 받지만, 설치 자체는 사용자의 동의 하에 수동으로 할 수 있게 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB70lEQVQoz22S2RKjIBBF8//fNi9TWV1Bkai4C65Z7lR3krexqgsa6OO9DYcsz5GbGv04YtsfWLcd/WBRdyN6O8PNK9y8wU4r7LRgdBTzf+KzfhCxh9IYvN/AG4CbZvw5+rjEOWJdIUo0ojSHymto0yErGtyrnud5PcC0FiVFM3J+cINBIgIMowV98zxDygR916JtKkgRIwx9CBFD6wxNXWFdFmzrgsk5dG2DtmngnIWzFodtsdAqglIa0zRhWRZ4nodMZdD6DiEEoihCGIYIwhB5nqPve7hpgrUOwzBwzPMC5xwO69xDRFfUTYvH48HAIPCRJAlUpuH5AZRKobVGWZZcTHOlFOI4RpoqZFkGYwyqqiLggEJLLOvGlvd9h0zkF5ixukRKLiIAjVRYVQZpmjJYSsljURRkeYSMPSSpwuv1YpVURNbatmVIGAbwfZ/Xf0oJShA6R3nTNOi67gOMgjP38Pl8MvB2veJ0OrFCgkVxhPv9ztZJFak3Zcm99oOAW0RO6DwDUxmgKEqGkeXb7Yrj8fixKWIOmhOMXsG2bXyBBCG7RZGzUrZMPfQuf78KHwylmyWrZINGyskqAX+W67rm/aqukegSRVnyHisU4RXGVKxu3zcEvo/z+cJ/pVun+LWDFFK+risrpZrpe4biH+CBNsDLTRDpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image1.png\"\n        title=\"image1.png\"\n        src=\"/static/fc7a888d13064fd23f9ab8b5760e76de/37523/image1.png\"\n        srcset=\"/static/fc7a888d13064fd23f9ab8b5760e76de/e9ff0/image1.png 180w,\n/static/fc7a888d13064fd23f9ab8b5760e76de/f21e7/image1.png 360w,\n/static/fc7a888d13064fd23f9ab8b5760e76de/37523/image1.png 720w,\n/static/fc7a888d13064fd23f9ab8b5760e76de/302a4/image1.png 1080w,\n/static/fc7a888d13064fd23f9ab8b5760e76de/07a9c/image1.png 1440w,\n/static/fc7a888d13064fd23f9ab8b5760e76de/9d362/image1.png 3278w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n</ul>\n<h4 id=\"2-1-인트라넷-환경인-것-처럼-설정하기\" style=\"position:relative;\"><a href=\"#2-1-%EC%9D%B8%ED%8A%B8%EB%9D%BC%EB%84%B7-%ED%99%98%EA%B2%BD%EC%9D%B8-%EA%B2%83-%EC%B2%98%EB%9F%BC-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"2 1 인트라넷 환경인 것 처럼 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-1. 인트라넷 환경인 것 처럼 설정하기</h4>\n<ul>\n<li>\n<p>위와 같이 자동 업데이트 설정을 변경하기만 해도 OS 업데이트로 인한 재부팅을 대부분 방지 할 수 있지만, 위와 동일 경로에서 ‘인트라넷 Microsoft 업데이트 서비스 위치 지정’을 하게 되면 업데이트 소스를 인터넷 MS 클라우드가 아닌 인트라넷으로부터 받아오게 설정할 수 있다. 그리고 여기에 존재하지 않는 dummy 도메인을 적어주게 되면 OS 업데이트 자체를 방지할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACFUlEQVQ4y32S6Y6bQBCEef8ny691vNYuh8GAOYdhuMGYq6JuBIpWSkYqcTVfV02PlmQSsZDo+gHvacZrfKNuOxRVi6od0A0jq+1fp5pu+Ke0h/vAOM1Y1w20ZK7w6/KNi+FDdyN4kYAXSURZhVS1iGSNkO6L/V6U3V/qoYW+hSyTWJaFgaoo4PohxmFAVSo8HBuOY8NzXURhgFJJiDTBMk9omxrbumJbF9a6zNBU6sL3AyilGFgUBeIoQhCE8DwfQRCwZJYhLyo8QoEwTpDnOdq2RdO2+7VpkKYptCx24DgPSCmxzAvKsoRhGLAsC57nQQjBP4zjiGF4oWo6tF2Hvu/53fv95us8z0iSBJpMHlCqwLqu7JB+Nk0Tvu9D5jk7ps6kLMsgRMpNjneUjEzUdY0oinYgxWvqmoHU2bJMdkmxSASgBCRqQPGo8TAM3IRABHdddwdalo2qqk6Ht9snAykCwcjF6/ViHcM7Fn3XdZ1htu1Ay1MX97t9DoWAH5cP3G43xPHemWIekcll13XnFlENbZFt27tDEdmwrDuD1m3jyI7jwLbvp8MdKlCUJdcRcJqn/ZgpBc/38HzuJ0JLAgu6bqDvOy6g4s/rJ0O3bWMnhyguTZM0TRM/E+R6veL35QLTtPY9fD4DBlEBgb+/vjgGxSMHh2ggP0Xu4zhmsUMlPFR1g21bzynTfhjmPmVy+T/9XH8AZhTVT/kgsuQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image2.png\"\n        title=\"image2.png\"\n        src=\"/static/74e9a879088e9e6c22ba8e9a1b87734b/37523/image2.png\"\n        srcset=\"/static/74e9a879088e9e6c22ba8e9a1b87734b/e9ff0/image2.png 180w,\n/static/74e9a879088e9e6c22ba8e9a1b87734b/f21e7/image2.png 360w,\n/static/74e9a879088e9e6c22ba8e9a1b87734b/37523/image2.png 720w,\n/static/74e9a879088e9e6c22ba8e9a1b87734b/302a4/image2.png 1080w,\n/static/74e9a879088e9e6c22ba8e9a1b87734b/07a9c/image2.png 1440w,\n/static/74e9a879088e9e6c22ba8e9a1b87734b/57dee/image2.png 3004w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n<li>\n<p>정책 바로 적용하기 : cmd 관리자 권한으로 열고 <code class=\"language-text\">gpupdate /force</code> 실행</p>\n</li>\n</ul>\n<h4 id=\"2-2-dualscan-비활성화-하기\" style=\"position:relative;\"><a href=\"#2-2-dualscan-%EB%B9%84%ED%99%9C%EC%84%B1%ED%99%94-%ED%95%98%EA%B8%B0\" aria-label=\"2 2 dualscan 비활성화 하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-2. DualScan 비활성화 하기</h4>\n<ul>\n<li>\n<p>그런데 2-1과 같이 정책 설정을 하더라도, Windows는 기본적으로 ‘DualScan’ 이라는 것이 있어서 인트라넷에서 못 받아오면 다시 MS 클라우드로부터 가져오도록 시도하게 되는데, Registry 편집기에서 HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate 위치에 DWORD로 ‘DisableDualScan’ 값을 1로 하여 키를 추가하게 되면 DualScan이 차단되어서 반드시 인트라넷 도메인으로부터만 업데이트를 시도하게 되고 그건 실재하지 않는 주소이기에 OS 업데이트가 원천 차단되게 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABUklEQVQ4y62Ti26DMAxF+f/f26vTWiiUUkLHI4OQhDzulGxUtFCpTLNkyZGt4+skDrbhFvsoBCEFCCEoijOqqkZZlqiqCpxzCCHQtq2PGWPgQqDruktu6oGRJdJ4g45xKKUgpYTWGtZa77AWxlok+xj5KfeNHeh4PIJSCmdjrfNAK4GSvHvgMEjfxQHHQmfuvPvYIQojD3RNSZ571dM6Z4HRAvnhCXVNYYy+JC4KAQ+om8bHxpgrwBhfKfw8bdBzOQNNgc0v8BYwU+iATiEXwyx5Dzj1W7gfmaQvKMtmlcJ7FmjFcc5ewXo3sp2N9Qeg9HdI6dc/KTQAowmyNIRyh5t7+gEO64Bdk+BM0vEpFhXWjwKVtpA9AckitC1b/IeDUouf+D6QEcThGw6HDLzvZwrdpnAu1gBzFHkMzqVfP7cNcyB/HChYgWj7DErbxUdZA/wGvxKZPRWOalYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image3.png\"\n        title=\"image3.png\"\n        src=\"/static/e82004ba811077222ed168847f2fdd97/37523/image3.png\"\n        srcset=\"/static/e82004ba811077222ed168847f2fdd97/e9ff0/image3.png 180w,\n/static/e82004ba811077222ed168847f2fdd97/f21e7/image3.png 360w,\n/static/e82004ba811077222ed168847f2fdd97/37523/image3.png 720w,\n/static/e82004ba811077222ed168847f2fdd97/302a4/image3.png 1080w,\n/static/e82004ba811077222ed168847f2fdd97/07a9c/image3.png 1440w,\n/static/e82004ba811077222ed168847f2fdd97/4b4ec/image3.png 2576w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<br></p>\n</li>\n<li>\n<p>레지스트리는 정책과 달리 반드시 서버를 재부팅해줘야만 변경사항이 적용된다!</p>\n</li>\n</ul>\n<h3 id=\"이벤트-41--kernel-power\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-41--kernel-power\" aria-label=\"이벤트 41  kernel power permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이벤트 41 : Kernel-power</h3>\n<p>이거는 파워 공급 불안정이 이유일 수도 있고, 다른 하드웨어적인 이유일 수도 있어서 원인 파악이 매우 어렵다.\n콘센트를 바꿔 꽂아보라는 얘기가 있는데 시도해봐야 할듯.</p>\n<hr>\n<h2 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h2>\n<ul>\n<li>이벤트 뷰어를 통해 OS 다운 관련 이벤트 확인하기 : <a href=\"https://m.blog.naver.com/toruin84/222376936262\">https://m.blog.naver.com/toruin84/222376936262</a></li>\n<li><a href=\"https://coolenjoy.net/bbs/tip/409629\">https://coolenjoy.net/bbs/tip/409629</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=OlGY64Usez0\">https://www.youtube.com/watch?v=OlGY64Usez0</a>\n<ul>\n<li>마지막 단계의 ‘전원 문제 마법사’ 는 실행하고 나서 불필요하게 오히려 절전 모드로 변경된다던가 하는 설정 변경이 자동 적용되어버렸는지 검수하고 복구 필요할 수도 있음.</li>\n</ul>\n</li>\n</ul>","frontmatter":{"date":"June 16, 2024","title":"On-premise 8. 호스트 서버 모니터링 및 꺼짐 방지","categories":"DevOps","author":"jjunyong","emoji":"🧢"},"fields":{"slug":"/on-premise8/"}},"site":{"siteMetadata":{"siteUrl":"https://jjunyong.github.io","comments":{"utterances":{"repo":"jjunyong/jjunyong.github.io"}}}}},"pageContext":{"slug":"/troubleshoot-istio-tls/","nextSlug":"/kotlin5/","prevSlug":"/on-premise8/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}